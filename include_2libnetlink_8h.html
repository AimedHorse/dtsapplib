<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>DTS Application Library: src/libnetlink/include/libnetlink.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">DTS Application Library
   &#160;<span id="projectnumber">0.00</span>
   </div>
   <div id="projectbrief">Application library containing referenced objects and interfaces to common libraries</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('include_2libnetlink_8h.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">libnetlink.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;string.h&gt;</code><br/>
<code>#include &lt;asm/types.h&gt;</code><br/>
<code>#include &lt;linux/netlink.h&gt;</code><br/>
<code>#include &lt;linux/rtnetlink.h&gt;</code><br/>
<code>#include &lt;linux/if_link.h&gt;</code><br/>
<code>#include &lt;linux/if_addr.h&gt;</code><br/>
<code>#include &lt;linux/neighbour.h&gt;</code><br/>
</div>
<p><a href="include_2libnetlink_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structrtnl__handle.html">rtnl_handle</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structrtnl__dump__filter__arg.html">rtnl_dump_filter_arg</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ab5023eccbd007fd6eb91c1be028e974b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="include_2libnetlink_8h.html#ab5023eccbd007fd6eb91c1be028e974b">parse_rtattr_nested</a>(tb, max, rta)&#160;&#160;&#160;(<a class="el" href="libnetlink_8h.html#aed575cd447219f8c2f67e2011aaee4d8">parse_rtattr</a>((tb), (max), RTA_DATA(rta), RTA_PAYLOAD(rta)))</td></tr>
<tr class="separator:ab5023eccbd007fd6eb91c1be028e974b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1380d7eddeb42ff298dd8977f3d217ad"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="include_2libnetlink_8h.html#a1380d7eddeb42ff298dd8977f3d217ad">parse_rtattr_nested_compat</a>(tb, max, rta, data, len)</td></tr>
<tr class="separator:a1380d7eddeb42ff298dd8977f3d217ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65c9772da492944cb5c8785c8a6ed3a5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="include_2libnetlink_8h.html#a65c9772da492944cb5c8785c8a6ed3a5">NLMSG_TAIL</a>(nmsg)&#160;&#160;&#160;((struct rtattr *) (((char*)(nmsg)) + NLMSG_ALIGN((nmsg)-&gt;nlmsg_len)))</td></tr>
<tr class="separator:a65c9772da492944cb5c8785c8a6ed3a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5dcfe5885409eae70f13a03299f518e4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="include_2libnetlink_8h.html#a5dcfe5885409eae70f13a03299f518e4">IFA_RTA</a>(r)&#160;&#160;&#160;((struct rtattr*)(((char*)(r)) + NLMSG_ALIGN(sizeof(struct ifaddrmsg))))</td></tr>
<tr class="separator:a5dcfe5885409eae70f13a03299f518e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6b20a22b33c9c83c29805977f336563"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="include_2libnetlink_8h.html#ad6b20a22b33c9c83c29805977f336563">IFA_PAYLOAD</a>(n)&#160;&#160;&#160;NLMSG_PAYLOAD(n,sizeof(struct ifaddrmsg))</td></tr>
<tr class="separator:ad6b20a22b33c9c83c29805977f336563"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55ecc1620b99402e5eb0f2bce8e4fe1f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="include_2libnetlink_8h.html#a55ecc1620b99402e5eb0f2bce8e4fe1f">IFLA_RTA</a>(r)&#160;&#160;&#160;((struct rtattr*)(((char*)(r)) + NLMSG_ALIGN(sizeof(struct ifinfomsg))))</td></tr>
<tr class="separator:a55ecc1620b99402e5eb0f2bce8e4fe1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a991dce91ce97424104a4fe8c6860c78f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="include_2libnetlink_8h.html#a991dce91ce97424104a4fe8c6860c78f">IFLA_PAYLOAD</a>(n)&#160;&#160;&#160;NLMSG_PAYLOAD(n,sizeof(struct ifinfomsg))</td></tr>
<tr class="separator:a991dce91ce97424104a4fe8c6860c78f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33af652fca825bdb9b71f5099e304722"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="include_2libnetlink_8h.html#a33af652fca825bdb9b71f5099e304722">NDA_RTA</a>(r)&#160;&#160;&#160;((struct rtattr*)(((char*)(r)) + NLMSG_ALIGN(sizeof(struct ndmsg))))</td></tr>
<tr class="separator:a33af652fca825bdb9b71f5099e304722"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34ff071ed370c5539030d009ad1389af"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="include_2libnetlink_8h.html#a34ff071ed370c5539030d009ad1389af">NDA_PAYLOAD</a>(n)&#160;&#160;&#160;NLMSG_PAYLOAD(n,sizeof(struct ndmsg))</td></tr>
<tr class="separator:a34ff071ed370c5539030d009ad1389af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a736d17e94c9d616c2b2ac91aa5a305"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="include_2libnetlink_8h.html#a1a736d17e94c9d616c2b2ac91aa5a305">NDTA_RTA</a>(r)&#160;&#160;&#160;((struct rtattr*)(((char*)(r)) + NLMSG_ALIGN(sizeof(struct ndtmsg))))</td></tr>
<tr class="separator:a1a736d17e94c9d616c2b2ac91aa5a305"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2bf5f3421ce1f766e0414d681595d6bb"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="include_2libnetlink_8h.html#a2bf5f3421ce1f766e0414d681595d6bb">NDTA_PAYLOAD</a>(n)&#160;&#160;&#160;NLMSG_PAYLOAD(n,sizeof(struct ndtmsg))</td></tr>
<tr class="separator:a2bf5f3421ce1f766e0414d681595d6bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ae75da56ead3fca07646a8636730ba7da"><td class="memItemLeft" align="right" valign="top">typedef int(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="include_2libnetlink_8h.html#ae75da56ead3fca07646a8636730ba7da">rtnl_filter_t</a> )(const struct sockaddr_nl *, struct nlmsghdr *n, void *)</td></tr>
<tr class="separator:ae75da56ead3fca07646a8636730ba7da"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:af6a834b458ad515cfe591cd720b5a3fd"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="include_2libnetlink_8h.html#af6a834b458ad515cfe591cd720b5a3fd">rtnl_open</a> (struct <a class="el" href="structrtnl__handle.html">rtnl_handle</a> *rth, unsigned subscriptions)</td></tr>
<tr class="separator:af6a834b458ad515cfe591cd720b5a3fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adcef0338bcf67064f61e984ea6542a4f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="include_2libnetlink_8h.html#adcef0338bcf67064f61e984ea6542a4f">rtnl_open_byproto</a> (struct <a class="el" href="structrtnl__handle.html">rtnl_handle</a> *rth, unsigned subscriptions, int protocol)</td></tr>
<tr class="separator:adcef0338bcf67064f61e984ea6542a4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe941df1a4b224511e5aba5fbeda5373"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="include_2libnetlink_8h.html#abe941df1a4b224511e5aba5fbeda5373">rtnl_close</a> (struct <a class="el" href="structrtnl__handle.html">rtnl_handle</a> *rth)</td></tr>
<tr class="separator:abe941df1a4b224511e5aba5fbeda5373"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d89c9b26f1bf5a091e6296298df671e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="include_2libnetlink_8h.html#a5d89c9b26f1bf5a091e6296298df671e">rtnl_wilddump_request</a> (struct <a class="el" href="structrtnl__handle.html">rtnl_handle</a> *rth, int fam, int type)</td></tr>
<tr class="separator:a5d89c9b26f1bf5a091e6296298df671e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27afc1b9833591d8deca9c2ad4fedd8f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="include_2libnetlink_8h.html#a27afc1b9833591d8deca9c2ad4fedd8f">rtnl_dump_request</a> (struct <a class="el" href="structrtnl__handle.html">rtnl_handle</a> *rth, int type, void *req, int len)</td></tr>
<tr class="separator:a27afc1b9833591d8deca9c2ad4fedd8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8fcd359fa96ab84664ff0fab494369a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="include_2libnetlink_8h.html#ae8fcd359fa96ab84664ff0fab494369a">rtnl_dump_filter_l</a> (struct <a class="el" href="structrtnl__handle.html">rtnl_handle</a> *rth, const struct <a class="el" href="structrtnl__dump__filter__arg.html">rtnl_dump_filter_arg</a> *arg)</td></tr>
<tr class="separator:ae8fcd359fa96ab84664ff0fab494369a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff3e26c0685ed303b1e8f1a0be29f96b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="include_2libnetlink_8h.html#aff3e26c0685ed303b1e8f1a0be29f96b">rtnl_dump_filter</a> (struct <a class="el" href="structrtnl__handle.html">rtnl_handle</a> *rth, <a class="el" href="libnetlink_8h.html#ae75da56ead3fca07646a8636730ba7da">rtnl_filter_t</a> filter, void *arg)</td></tr>
<tr class="separator:aff3e26c0685ed303b1e8f1a0be29f96b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accbb65e468ec1fe95dca844dcdb03493"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="include_2libnetlink_8h.html#accbb65e468ec1fe95dca844dcdb03493">rtnl_talk</a> (struct <a class="el" href="structrtnl__handle.html">rtnl_handle</a> *rtnl, struct nlmsghdr *n, pid_t peer, unsigned groups, struct nlmsghdr *answer)</td></tr>
<tr class="separator:accbb65e468ec1fe95dca844dcdb03493"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a487fd362854361404e0f1c9cab663d85"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="include_2libnetlink_8h.html#a487fd362854361404e0f1c9cab663d85">rtnl_send</a> (struct <a class="el" href="structrtnl__handle.html">rtnl_handle</a> *rth, const void *buf, int)</td></tr>
<tr class="separator:a487fd362854361404e0f1c9cab663d85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af30370141d4ec3e4b6c3bce938e89992"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="include_2libnetlink_8h.html#af30370141d4ec3e4b6c3bce938e89992">rtnl_send_check</a> (struct <a class="el" href="structrtnl__handle.html">rtnl_handle</a> *rth, const void *buf, int)</td></tr>
<tr class="separator:af30370141d4ec3e4b6c3bce938e89992"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a499c8fb430a2f6e7547f2578b12f88d5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="include_2libnetlink_8h.html#a499c8fb430a2f6e7547f2578b12f88d5">addattr</a> (struct nlmsghdr *n, int maxlen, int type)</td></tr>
<tr class="separator:a499c8fb430a2f6e7547f2578b12f88d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae641e5c751064db5da164e5d8fe0b529"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="include_2libnetlink_8h.html#ae641e5c751064db5da164e5d8fe0b529">addattr8</a> (struct nlmsghdr *n, int maxlen, int type, __u8 data)</td></tr>
<tr class="separator:ae641e5c751064db5da164e5d8fe0b529"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a660890da2fbd7ca91809976e290f566f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="include_2libnetlink_8h.html#a660890da2fbd7ca91809976e290f566f">addattr16</a> (struct nlmsghdr *n, int maxlen, int type, __u16 data)</td></tr>
<tr class="separator:a660890da2fbd7ca91809976e290f566f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0077ba8ce749a916a3205eeb443a7a89"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="include_2libnetlink_8h.html#a0077ba8ce749a916a3205eeb443a7a89">addattr32</a> (struct nlmsghdr *n, int maxlen, int type, __u32 data)</td></tr>
<tr class="separator:a0077ba8ce749a916a3205eeb443a7a89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b3796827ba9ca1e7aefa2cdcbf629f5"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="include_2libnetlink_8h.html#a0b3796827ba9ca1e7aefa2cdcbf629f5">addattr64</a> (struct nlmsghdr *n, int maxlen, int type, __u64 data)</td></tr>
<tr class="separator:a0b3796827ba9ca1e7aefa2cdcbf629f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0515d64b9a4c05bd732b2cffaf5c72a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="include_2libnetlink_8h.html#af0515d64b9a4c05bd732b2cffaf5c72a">addattrstrz</a> (struct nlmsghdr *n, int maxlen, int type, const char *data)</td></tr>
<tr class="separator:af0515d64b9a4c05bd732b2cffaf5c72a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a308c9418a2d83e4e9ba8d8ed0b7bbe28"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="include_2libnetlink_8h.html#a308c9418a2d83e4e9ba8d8ed0b7bbe28">addattr_l</a> (struct nlmsghdr *n, int maxlen, int type, const void *data, int alen)</td></tr>
<tr class="separator:a308c9418a2d83e4e9ba8d8ed0b7bbe28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca2eef9dc434268904e814449a6f5191"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="include_2libnetlink_8h.html#aca2eef9dc434268904e814449a6f5191">addraw_l</a> (struct nlmsghdr *n, int maxlen, const void *data, int len)</td></tr>
<tr class="separator:aca2eef9dc434268904e814449a6f5191"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5523bafe5e3d7f7fb356943334d85fd7"><td class="memItemLeft" align="right" valign="top">struct rtattr *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="include_2libnetlink_8h.html#a5523bafe5e3d7f7fb356943334d85fd7">addattr_nest</a> (struct nlmsghdr *n, int maxlen, int type)</td></tr>
<tr class="separator:a5523bafe5e3d7f7fb356943334d85fd7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68da7387d95716ad4cff83f1ffe24550"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="include_2libnetlink_8h.html#a68da7387d95716ad4cff83f1ffe24550">addattr_nest_end</a> (struct nlmsghdr *n, struct rtattr *nest)</td></tr>
<tr class="separator:a68da7387d95716ad4cff83f1ffe24550"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a914c9130411dbc1c0ecd239390834c50"><td class="memItemLeft" align="right" valign="top">struct rtattr *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="include_2libnetlink_8h.html#a914c9130411dbc1c0ecd239390834c50">addattr_nest_compat</a> (struct nlmsghdr *n, int maxlen, int type, const void *data, int len)</td></tr>
<tr class="separator:a914c9130411dbc1c0ecd239390834c50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a937386ab6c57784ed8d4f489d867455a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="include_2libnetlink_8h.html#a937386ab6c57784ed8d4f489d867455a">addattr_nest_compat_end</a> (struct nlmsghdr *n, struct rtattr *nest)</td></tr>
<tr class="separator:a937386ab6c57784ed8d4f489d867455a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a989741a127101171b87f58bb234761b2"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="include_2libnetlink_8h.html#a989741a127101171b87f58bb234761b2">rta_addattr32</a> (struct rtattr *rta, int maxlen, int type, __u32 data)</td></tr>
<tr class="separator:a989741a127101171b87f58bb234761b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9788836cab7c0fa68a06532af4c91e19"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="include_2libnetlink_8h.html#a9788836cab7c0fa68a06532af4c91e19">rta_addattr_l</a> (struct rtattr *rta, int maxlen, int type, const void *data, int alen)</td></tr>
<tr class="separator:a9788836cab7c0fa68a06532af4c91e19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed575cd447219f8c2f67e2011aaee4d8"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="include_2libnetlink_8h.html#aed575cd447219f8c2f67e2011aaee4d8">parse_rtattr</a> (struct rtattr *tb[], int max, struct rtattr *rta, int len)</td></tr>
<tr class="separator:aed575cd447219f8c2f67e2011aaee4d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e26de787132f3b007987969b9828b62"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="include_2libnetlink_8h.html#a4e26de787132f3b007987969b9828b62">parse_rtattr_byindex</a> (struct rtattr *tb[], int max, struct rtattr *rta, int len)</td></tr>
<tr class="separator:a4e26de787132f3b007987969b9828b62"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ea9ae2a317e49d23c91fbfd42633976"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="include_2libnetlink_8h.html#a7ea9ae2a317e49d23c91fbfd42633976">__parse_rtattr_nested_compat</a> (struct rtattr *tb[], int max, struct rtattr *rta, int len)</td></tr>
<tr class="separator:a7ea9ae2a317e49d23c91fbfd42633976"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacc7a3663568d47caf34665e570d28f0"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="include_2libnetlink_8h.html#aacc7a3663568d47caf34665e570d28f0">rtnl_listen</a> (struct <a class="el" href="structrtnl__handle.html">rtnl_handle</a> *, <a class="el" href="libnetlink_8h.html#ae75da56ead3fca07646a8636730ba7da">rtnl_filter_t</a> handler, void *jarg)</td></tr>
<tr class="separator:aacc7a3663568d47caf34665e570d28f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed667520bef1b7d60686a3c61e3cf038"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="include_2libnetlink_8h.html#aed667520bef1b7d60686a3c61e3cf038">rtnl_from_file</a> (FILE *, <a class="el" href="libnetlink_8h.html#ae75da56ead3fca07646a8636730ba7da">rtnl_filter_t</a> handler, void *jarg)</td></tr>
<tr class="separator:aed667520bef1b7d60686a3c61e3cf038"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ac8965cf584a82cef83405486ac542f39"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="include_2libnetlink_8h.html#ac8965cf584a82cef83405486ac542f39">rcvbuf</a></td></tr>
<tr class="separator:ac8965cf584a82cef83405486ac542f39"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="ad6b20a22b33c9c83c29805977f336563"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IFA_PAYLOAD</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">n</td><td>)</td>
          <td>&#160;&#160;&#160;NLMSG_PAYLOAD(n,sizeof(struct ifaddrmsg))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="include_2libnetlink_8h_source.html#l00103">103</a> of file <a class="el" href="include_2libnetlink_8h_source.html">libnetlink.h</a>.</p>

</div>
</div>
<a class="anchor" id="a5dcfe5885409eae70f13a03299f518e4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IFA_RTA</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">r</td><td>)</td>
          <td>&#160;&#160;&#160;((struct rtattr*)(((char*)(r)) + NLMSG_ALIGN(sizeof(struct ifaddrmsg))))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="include_2libnetlink_8h_source.html#l00099">99</a> of file <a class="el" href="include_2libnetlink_8h_source.html">libnetlink.h</a>.</p>

</div>
</div>
<a class="anchor" id="a991dce91ce97424104a4fe8c6860c78f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IFLA_PAYLOAD</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">n</td><td>)</td>
          <td>&#160;&#160;&#160;NLMSG_PAYLOAD(n,sizeof(struct ifinfomsg))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="include_2libnetlink_8h_source.html#l00111">111</a> of file <a class="el" href="include_2libnetlink_8h_source.html">libnetlink.h</a>.</p>

<p>Referenced by <a class="el" href="ll__map_8c.html#a7bc4d64f30ee68d2f86b949f29afe7ae">ll_remember_index()</a>.</p>

</div>
</div>
<a class="anchor" id="a55ecc1620b99402e5eb0f2bce8e4fe1f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IFLA_RTA</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">r</td><td>)</td>
          <td>&#160;&#160;&#160;((struct rtattr*)(((char*)(r)) + NLMSG_ALIGN(sizeof(struct ifinfomsg))))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="include_2libnetlink_8h_source.html#l00107">107</a> of file <a class="el" href="include_2libnetlink_8h_source.html">libnetlink.h</a>.</p>

<p>Referenced by <a class="el" href="ll__map_8c.html#a7bc4d64f30ee68d2f86b949f29afe7ae">ll_remember_index()</a>.</p>

</div>
</div>
<a class="anchor" id="a34ff071ed370c5539030d009ad1389af"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NDA_PAYLOAD</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">n</td><td>)</td>
          <td>&#160;&#160;&#160;NLMSG_PAYLOAD(n,sizeof(struct ndmsg))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="include_2libnetlink_8h_source.html#l00119">119</a> of file <a class="el" href="include_2libnetlink_8h_source.html">libnetlink.h</a>.</p>

</div>
</div>
<a class="anchor" id="a33af652fca825bdb9b71f5099e304722"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NDA_RTA</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">r</td><td>)</td>
          <td>&#160;&#160;&#160;((struct rtattr*)(((char*)(r)) + NLMSG_ALIGN(sizeof(struct ndmsg))))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="include_2libnetlink_8h_source.html#l00115">115</a> of file <a class="el" href="include_2libnetlink_8h_source.html">libnetlink.h</a>.</p>

</div>
</div>
<a class="anchor" id="a2bf5f3421ce1f766e0414d681595d6bb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NDTA_PAYLOAD</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">n</td><td>)</td>
          <td>&#160;&#160;&#160;NLMSG_PAYLOAD(n,sizeof(struct ndtmsg))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="include_2libnetlink_8h_source.html#l00127">127</a> of file <a class="el" href="include_2libnetlink_8h_source.html">libnetlink.h</a>.</p>

</div>
</div>
<a class="anchor" id="a1a736d17e94c9d616c2b2ac91aa5a305"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NDTA_RTA</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">r</td><td>)</td>
          <td>&#160;&#160;&#160;((struct rtattr*)(((char*)(r)) + NLMSG_ALIGN(sizeof(struct ndtmsg))))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="include_2libnetlink_8h_source.html#l00123">123</a> of file <a class="el" href="include_2libnetlink_8h_source.html">libnetlink.h</a>.</p>

</div>
</div>
<a class="anchor" id="a65c9772da492944cb5c8785c8a6ed3a5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define NLMSG_TAIL</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">nmsg</td><td>)</td>
          <td>&#160;&#160;&#160;((struct rtattr *) (((char*)(nmsg)) + NLMSG_ALIGN((nmsg)-&gt;nlmsg_len)))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="include_2libnetlink_8h_source.html#l00095">95</a> of file <a class="el" href="include_2libnetlink_8h_source.html">libnetlink.h</a>.</p>

<p>Referenced by <a class="el" href="libnetlink_8h.html#a308c9418a2d83e4e9ba8d8ed0b7bbe28">addattr_l()</a>, <a class="el" href="libnetlink_8h.html#a5523bafe5e3d7f7fb356943334d85fd7">addattr_nest()</a>, <a class="el" href="libnetlink_8h.html#a914c9130411dbc1c0ecd239390834c50">addattr_nest_compat()</a>, <a class="el" href="libnetlink_8h.html#a937386ab6c57784ed8d4f489d867455a">addattr_nest_compat_end()</a>, <a class="el" href="libnetlink_8h.html#a68da7387d95716ad4cff83f1ffe24550">addattr_nest_end()</a>, <a class="el" href="libnetlink_8h.html#aca2eef9dc434268904e814449a6f5191">addraw_l()</a>, <a class="el" href="group___l_i_b-_i_f_a_c_e.html#gae4744405b8a043979aa4ea1cfde174ef">create_kernmac()</a>, and <a class="el" href="group___l_i_b-_i_f_a_c_e.html#gad4b0322139d45ba2b60e21a639fa9c29">create_kernvlan()</a>.</p>

</div>
</div>
<a class="anchor" id="ab5023eccbd007fd6eb91c1be028e974b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define parse_rtattr_nested</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">tb, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">max, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">rta&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;(<a class="el" href="libnetlink_8h.html#aed575cd447219f8c2f67e2011aaee4d8">parse_rtattr</a>((tb), (max), RTA_DATA(rta), RTA_PAYLOAD(rta)))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="include_2libnetlink_8h_source.html#l00065">65</a> of file <a class="el" href="include_2libnetlink_8h_source.html">libnetlink.h</a>.</p>

<p>Referenced by <a class="el" href="libnetlink_8h.html#a7ea9ae2a317e49d23c91fbfd42633976">__parse_rtattr_nested_compat()</a>.</p>

</div>
</div>
<a class="anchor" id="a1380d7eddeb42ff298dd8977f3d217ad"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define parse_rtattr_nested_compat</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">tb, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">max, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">rta, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">data, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">len&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">({ data = RTA_PAYLOAD(rta) &gt;= len ? RTA_DATA(rta) : NULL;   \</div>
<div class="line">        __parse_rtattr_nested_compat(tb, max, rta, len); })</div>
</div><!-- fragment -->
<p>Definition at line <a class="el" href="include_2libnetlink_8h_source.html#l00068">68</a> of file <a class="el" href="include_2libnetlink_8h_source.html">libnetlink.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="ae75da56ead3fca07646a8636730ba7da"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef int(* rtnl_filter_t)(const struct sockaddr_nl *, struct nlmsghdr *n, void *)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="include_2libnetlink_8h_source.html#l00028">28</a> of file <a class="el" href="include_2libnetlink_8h_source.html">libnetlink.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a7ea9ae2a317e49d23c91fbfd42633976"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int __parse_rtattr_nested_compat </td>
          <td>(</td>
          <td class="paramtype">struct rtattr *&#160;</td>
          <td class="paramname"><em>tb</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct rtattr *&#160;</td>
          <td class="paramname"><em>rta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="libnetlink_8c_source.html#l00673">673</a> of file <a class="el" href="libnetlink_8c_source.html">libnetlink.c</a>.</p>
<div class="fragment"><div class="line">                                          {</div>
<div class="line">    <span class="keywordflow">if</span> (RTA_PAYLOAD(rta) &lt; len) {</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (RTA_PAYLOAD(rta) &gt;= RTA_ALIGN(len) + <span class="keyword">sizeof</span>(<span class="keyword">struct</span> rtattr)) {</div>
<div class="line">        rta = RTA_DATA(rta) + RTA_ALIGN(len);</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code" href="include_2libnetlink_8h.html#ab5023eccbd007fd6eb91c1be028e974b">parse_rtattr_nested</a>(tb, max, rta);</div>
<div class="line">    }</div>
<div class="line">    memset(tb, 0, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> rtattr *) * (max + 1));</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a499c8fb430a2f6e7547f2578b12f88d5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int addattr </td>
          <td>(</td>
          <td class="paramtype">struct nlmsghdr *&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="libnetlink_8c_source.html#l00528">528</a> of file <a class="el" href="libnetlink_8c_source.html">libnetlink.c</a>.</p>
<div class="fragment"><div class="line">                                                      {</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="include_2libnetlink_8h.html#a308c9418a2d83e4e9ba8d8ed0b7bbe28">addattr_l</a>(n, maxlen, type, NULL, 0);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a660890da2fbd7ca91809976e290f566f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int addattr16 </td>
          <td>(</td>
          <td class="paramtype">struct nlmsghdr *&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__u16&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="libnetlink_8c_source.html#l00536">536</a> of file <a class="el" href="libnetlink_8c_source.html">libnetlink.c</a>.</p>
<div class="fragment"><div class="line">                                                                    {</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="include_2libnetlink_8h.html#a308c9418a2d83e4e9ba8d8ed0b7bbe28">addattr_l</a>(n, maxlen, type, &amp;data, <span class="keyword">sizeof</span>(__u16));</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0077ba8ce749a916a3205eeb443a7a89"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int addattr32 </td>
          <td>(</td>
          <td class="paramtype">struct nlmsghdr *&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__u32&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="libnetlink_8c_source.html#l00540">540</a> of file <a class="el" href="libnetlink_8c_source.html">libnetlink.c</a>.</p>

<p>Referenced by <a class="el" href="group___l_i_b-_i_f_a_c_e.html#gae4744405b8a043979aa4ea1cfde174ef">create_kernmac()</a>, and <a class="el" href="group___l_i_b-_i_f_a_c_e.html#ga2f3e0de7dc564bb0a51656e0be0d82df">set_interface_ipaddr()</a>.</p>
<div class="fragment"><div class="line">                                                                    {</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="include_2libnetlink_8h.html#a308c9418a2d83e4e9ba8d8ed0b7bbe28">addattr_l</a>(n, maxlen, type, &amp;data, <span class="keyword">sizeof</span>(__u32));</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a0b3796827ba9ca1e7aefa2cdcbf629f5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int addattr64 </td>
          <td>(</td>
          <td class="paramtype">struct nlmsghdr *&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__u64&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="libnetlink_8c_source.html#l00544">544</a> of file <a class="el" href="libnetlink_8c_source.html">libnetlink.c</a>.</p>
<div class="fragment"><div class="line">                                                                    {</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="include_2libnetlink_8h.html#a308c9418a2d83e4e9ba8d8ed0b7bbe28">addattr_l</a>(n, maxlen, type, &amp;data, <span class="keyword">sizeof</span>(__u64));</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae641e5c751064db5da164e5d8fe0b529"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int addattr8 </td>
          <td>(</td>
          <td class="paramtype">struct nlmsghdr *&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__u8&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="libnetlink_8c_source.html#l00532">532</a> of file <a class="el" href="libnetlink_8c_source.html">libnetlink.c</a>.</p>
<div class="fragment"><div class="line">                                                                  {</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="include_2libnetlink_8h.html#a308c9418a2d83e4e9ba8d8ed0b7bbe28">addattr_l</a>(n, maxlen, type, &amp;data, <span class="keyword">sizeof</span>(__u8));</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a308c9418a2d83e4e9ba8d8ed0b7bbe28"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int addattr_l </td>
          <td>(</td>
          <td class="paramtype">struct nlmsghdr *&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>alen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="libnetlink_8c_source.html#l00552">552</a> of file <a class="el" href="libnetlink_8c_source.html">libnetlink.c</a>.</p>

<p>Referenced by <a class="el" href="libnetlink_8h.html#a499c8fb430a2f6e7547f2578b12f88d5">addattr()</a>, <a class="el" href="libnetlink_8h.html#a660890da2fbd7ca91809976e290f566f">addattr16()</a>, <a class="el" href="libnetlink_8h.html#a0077ba8ce749a916a3205eeb443a7a89">addattr32()</a>, <a class="el" href="libnetlink_8h.html#a0b3796827ba9ca1e7aefa2cdcbf629f5">addattr64()</a>, <a class="el" href="libnetlink_8h.html#ae641e5c751064db5da164e5d8fe0b529">addattr8()</a>, <a class="el" href="libnetlink_8h.html#a5523bafe5e3d7f7fb356943334d85fd7">addattr_nest()</a>, <a class="el" href="libnetlink_8h.html#a914c9130411dbc1c0ecd239390834c50">addattr_nest_compat()</a>, <a class="el" href="libnetlink_8h.html#af0515d64b9a4c05bd732b2cffaf5c72a">addattrstrz()</a>, <a class="el" href="group___l_i_b-_i_f_a_c_e.html#gae4744405b8a043979aa4ea1cfde174ef">create_kernmac()</a>, <a class="el" href="group___l_i_b-_i_f_a_c_e.html#gad4b0322139d45ba2b60e21a639fa9c29">create_kernvlan()</a>, <a class="el" href="group___l_i_b-_i_f_a_c_e.html#ga67dcdb7d1138121755d36d6e3f9e7196">set_interface_addr()</a>, <a class="el" href="group___l_i_b-_i_f_a_c_e.html#ga2f3e0de7dc564bb0a51656e0be0d82df">set_interface_ipaddr()</a>, and <a class="el" href="group___l_i_b-_i_f_a_c_e.html#gaf84e9152d0c6c803c75b6f47772a22ba">set_interface_name()</a>.</p>
<div class="fragment"><div class="line">                        {</div>
<div class="line">    <span class="keywordtype">int</span> len = RTA_LENGTH(alen);</div>
<div class="line">    <span class="keyword">struct </span>rtattr *rta;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (NLMSG_ALIGN(n-&gt;nlmsg_len) + RTA_ALIGN(len) &gt; maxlen) {</div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;addattr_l ERROR: message exceeded bound of %d\n&quot;</span>,maxlen);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line">    rta = <a class="code" href="include_2libnetlink_8h.html#a65c9772da492944cb5c8785c8a6ed3a5">NLMSG_TAIL</a>(n);</div>
<div class="line">    rta-&gt;rta_type = type;</div>
<div class="line">    rta-&gt;rta_len = len;</div>
<div class="line">    memcpy(RTA_DATA(rta), data, alen);</div>
<div class="line">    n-&gt;nlmsg_len = NLMSG_ALIGN(n-&gt;nlmsg_len) + RTA_ALIGN(len);</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5523bafe5e3d7f7fb356943334d85fd7"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct rtattr* addattr_nest </td>
          <td>(</td>
          <td class="paramtype">struct nlmsghdr *&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">read</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="libnetlink_8c_source.html#l00581">581</a> of file <a class="el" href="libnetlink_8c_source.html">libnetlink.c</a>.</p>

<p>Referenced by <a class="el" href="libnetlink_8h.html#a914c9130411dbc1c0ecd239390834c50">addattr_nest_compat()</a>.</p>
<div class="fragment"><div class="line">                                                                      {</div>
<div class="line">    <span class="keyword">struct </span>rtattr *nest = <a class="code" href="include_2libnetlink_8h.html#a65c9772da492944cb5c8785c8a6ed3a5">NLMSG_TAIL</a>(n);</div>
<div class="line"></div>
<div class="line">    <a class="code" href="include_2libnetlink_8h.html#a308c9418a2d83e4e9ba8d8ed0b7bbe28">addattr_l</a>(n, maxlen, type, NULL, 0);</div>
<div class="line">    <span class="keywordflow">return</span> nest;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a914c9130411dbc1c0ecd239390834c50"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct rtattr* addattr_nest_compat </td>
          <td>(</td>
          <td class="paramtype">struct nlmsghdr *&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">read</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="libnetlink_8c_source.html#l00593">593</a> of file <a class="el" href="libnetlink_8c_source.html">libnetlink.c</a>.</p>
<div class="fragment"><div class="line">                                                              {</div>
<div class="line">    <span class="keyword">struct </span>rtattr *start = <a class="code" href="include_2libnetlink_8h.html#a65c9772da492944cb5c8785c8a6ed3a5">NLMSG_TAIL</a>(n);</div>
<div class="line"></div>
<div class="line">    <a class="code" href="include_2libnetlink_8h.html#a308c9418a2d83e4e9ba8d8ed0b7bbe28">addattr_l</a>(n, maxlen, type, data, len);</div>
<div class="line">    <a class="code" href="include_2libnetlink_8h.html#a5523bafe5e3d7f7fb356943334d85fd7">addattr_nest</a>(n, maxlen, type);</div>
<div class="line">    <span class="keywordflow">return</span> start;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a937386ab6c57784ed8d4f489d867455a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int addattr_nest_compat_end </td>
          <td>(</td>
          <td class="paramtype">struct nlmsghdr *&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct rtattr *&#160;</td>
          <td class="paramname"><em>nest</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="libnetlink_8c_source.html#l00602">602</a> of file <a class="el" href="libnetlink_8c_source.html">libnetlink.c</a>.</p>
<div class="fragment"><div class="line">                                                                      {</div>
<div class="line">    <span class="keyword">struct </span>rtattr *nest = (<span class="keywordtype">void</span> *)start + NLMSG_ALIGN(start-&gt;rta_len);</div>
<div class="line"></div>
<div class="line">    start-&gt;rta_len = (<span class="keywordtype">void</span> *)<a class="code" href="include_2libnetlink_8h.html#a65c9772da492944cb5c8785c8a6ed3a5">NLMSG_TAIL</a>(n) - (<span class="keywordtype">void</span> *)start;</div>
<div class="line">    <a class="code" href="include_2libnetlink_8h.html#a68da7387d95716ad4cff83f1ffe24550">addattr_nest_end</a>(n, nest);</div>
<div class="line">    <span class="keywordflow">return</span> n-&gt;nlmsg_len;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a68da7387d95716ad4cff83f1ffe24550"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int addattr_nest_end </td>
          <td>(</td>
          <td class="paramtype">struct nlmsghdr *&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct rtattr *&#160;</td>
          <td class="paramname"><em>nest</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="libnetlink_8c_source.html#l00588">588</a> of file <a class="el" href="libnetlink_8c_source.html">libnetlink.c</a>.</p>

<p>Referenced by <a class="el" href="libnetlink_8h.html#a937386ab6c57784ed8d4f489d867455a">addattr_nest_compat_end()</a>.</p>
<div class="fragment"><div class="line">                                                              {</div>
<div class="line">    nest-&gt;rta_len = (<span class="keywordtype">void</span> *)<a class="code" href="include_2libnetlink_8h.html#a65c9772da492944cb5c8785c8a6ed3a5">NLMSG_TAIL</a>(n) - (<span class="keywordtype">void</span> *)nest;</div>
<div class="line">    <span class="keywordflow">return</span> n-&gt;nlmsg_len;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af0515d64b9a4c05bd732b2cffaf5c72a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int addattrstrz </td>
          <td>(</td>
          <td class="paramtype">struct nlmsghdr *&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="libnetlink_8c_source.html#l00548">548</a> of file <a class="el" href="libnetlink_8c_source.html">libnetlink.c</a>.</p>
<div class="fragment"><div class="line">                                                                           {</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="include_2libnetlink_8h.html#a308c9418a2d83e4e9ba8d8ed0b7bbe28">addattr_l</a>(n, maxlen, type, str, strlen(str)+1);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aca2eef9dc434268904e814449a6f5191"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int addraw_l </td>
          <td>(</td>
          <td class="paramtype">struct nlmsghdr *&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="libnetlink_8c_source.html#l00569">569</a> of file <a class="el" href="libnetlink_8c_source.html">libnetlink.c</a>.</p>
<div class="fragment"><div class="line">                                                                        {</div>
<div class="line">    <span class="keywordflow">if</span> (NLMSG_ALIGN(n-&gt;nlmsg_len) + NLMSG_ALIGN(len) &gt; maxlen) {</div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;addraw_l ERROR: message exceeded bound of %d\n&quot;</span>,maxlen);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    memcpy(<a class="code" href="include_2libnetlink_8h.html#a65c9772da492944cb5c8785c8a6ed3a5">NLMSG_TAIL</a>(n), data, len);</div>
<div class="line">    memset((<span class="keywordtype">void</span> *) <a class="code" href="include_2libnetlink_8h.html#a65c9772da492944cb5c8785c8a6ed3a5">NLMSG_TAIL</a>(n) + len, 0, NLMSG_ALIGN(len) - len);</div>
<div class="line">    n-&gt;nlmsg_len = NLMSG_ALIGN(n-&gt;nlmsg_len) + NLMSG_ALIGN(len);</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aed575cd447219f8c2f67e2011aaee4d8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int parse_rtattr </td>
          <td>(</td>
          <td class="paramtype">struct rtattr *&#160;</td>
          <td class="paramname"><em>tb</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct rtattr *&#160;</td>
          <td class="paramname"><em>rta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="libnetlink_8c_source.html#l00643">643</a> of file <a class="el" href="libnetlink_8c_source.html">libnetlink.c</a>.</p>

<p>Referenced by <a class="el" href="ll__map_8c.html#a7bc4d64f30ee68d2f86b949f29afe7ae">ll_remember_index()</a>.</p>
<div class="fragment"><div class="line">                                                                            {</div>
<div class="line">    memset(tb, 0, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> rtattr *) * (max + 1));</div>
<div class="line">    <span class="keywordflow">while</span> (RTA_OK(rta, len)) {</div>
<div class="line">        <span class="keywordflow">if</span> ((rta-&gt;rta_type &lt;= max) &amp;&amp; (!tb[rta-&gt;rta_type])) {</div>
<div class="line">            tb[rta-&gt;rta_type] = rta;</div>
<div class="line">        }</div>
<div class="line">        rta = RTA_NEXT(rta,len);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (len) {</div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;!!!Deficit %d, rta_len=%d\n&quot;</span>, len, rta-&gt;rta_len);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4e26de787132f3b007987969b9828b62"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int parse_rtattr_byindex </td>
          <td>(</td>
          <td class="paramtype">struct rtattr *&#160;</td>
          <td class="paramname"><em>tb</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct rtattr *&#160;</td>
          <td class="paramname"><em>rta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="libnetlink_8c_source.html#l00657">657</a> of file <a class="el" href="libnetlink_8c_source.html">libnetlink.c</a>.</p>
<div class="fragment"><div class="line">                                                                                    {</div>
<div class="line">    <span class="keywordtype">int</span> i = 0;</div>
<div class="line"></div>
<div class="line">    memset(tb, 0, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> rtattr *) * max);</div>
<div class="line">    <span class="keywordflow">while</span> (RTA_OK(rta, len)) {</div>
<div class="line">        <span class="keywordflow">if</span> (rta-&gt;rta_type &lt;= max &amp;&amp; i &lt; max) {</div>
<div class="line">            tb[i++] = rta;</div>
<div class="line">        }</div>
<div class="line">        rta = RTA_NEXT(rta,len);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (len) {</div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;!!!Deficit %d, rta_len=%d\n&quot;</span>, len, rta-&gt;rta_len);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> i;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a989741a127101171b87f58bb234761b2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rta_addattr32 </td>
          <td>(</td>
          <td class="paramtype">struct rtattr *&#160;</td>
          <td class="paramname"><em>rta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">__u32&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="libnetlink_8c_source.html#l00610">610</a> of file <a class="el" href="libnetlink_8c_source.html">libnetlink.c</a>.</p>
<div class="fragment"><div class="line">                                                                        {</div>
<div class="line">    <span class="keywordtype">int</span> len = RTA_LENGTH(4);</div>
<div class="line">    <span class="keyword">struct </span>rtattr *subrta;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (RTA_ALIGN(rta-&gt;rta_len) + len &gt; maxlen) {</div>
<div class="line">        fprintf(stderr,<span class="stringliteral">&quot;rta_addattr32: Error! max allowed bound %d exceeded\n&quot;</span>,maxlen);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line">    subrta = (<span class="keyword">struct </span>rtattr *)(((<span class="keywordtype">char</span> *)rta) + RTA_ALIGN(rta-&gt;rta_len));</div>
<div class="line">    subrta-&gt;rta_type = type;</div>
<div class="line">    subrta-&gt;rta_len = len;</div>
<div class="line">    memcpy(RTA_DATA(subrta), &amp;data, 4);</div>
<div class="line">    rta-&gt;rta_len = NLMSG_ALIGN(rta-&gt;rta_len) + len;</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9788836cab7c0fa68a06532af4c91e19"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rta_addattr_l </td>
          <td>(</td>
          <td class="paramtype">struct rtattr *&#160;</td>
          <td class="paramname"><em>rta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>maxlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>alen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="libnetlink_8c_source.html#l00626">626</a> of file <a class="el" href="libnetlink_8c_source.html">libnetlink.c</a>.</p>
<div class="fragment"><div class="line">                                              {</div>
<div class="line">    <span class="keyword">struct </span>rtattr *subrta;</div>
<div class="line">    <span class="keywordtype">int</span> len = RTA_LENGTH(alen);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (RTA_ALIGN(rta-&gt;rta_len) + RTA_ALIGN(len) &gt; maxlen) {</div>
<div class="line">        fprintf(stderr,<span class="stringliteral">&quot;rta_addattr_l: Error! max allowed bound %d exceeded\n&quot;</span>,maxlen);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line">    subrta = (<span class="keyword">struct </span>rtattr *)(((<span class="keywordtype">char</span> *)rta) + RTA_ALIGN(rta-&gt;rta_len));</div>
<div class="line">    subrta-&gt;rta_type = type;</div>
<div class="line">    subrta-&gt;rta_len = len;</div>
<div class="line">    memcpy(RTA_DATA(subrta), data, alen);</div>
<div class="line">    rta-&gt;rta_len = NLMSG_ALIGN(rta-&gt;rta_len) + RTA_ALIGN(len);</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="abe941df1a4b224511e5aba5fbeda5373"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rtnl_close </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structrtnl__handle.html">rtnl_handle</a> *&#160;</td>
          <td class="paramname"><em>rth</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="libnetlink_8c_source.html#l00030">30</a> of file <a class="el" href="libnetlink_8c_source.html">libnetlink.c</a>.</p>
<div class="fragment"><div class="line">                                         {</div>
<div class="line">    <span class="keywordflow">if</span> (rth-&gt;<a class="code" href="structrtnl__handle.html#a58397dc05569f5250b2bde1e40d2ddd2">fd</a> &gt;= 0) {</div>
<div class="line">        close(rth-&gt;<a class="code" href="structrtnl__handle.html#a58397dc05569f5250b2bde1e40d2ddd2">fd</a>);</div>
<div class="line">        rth-&gt;<a class="code" href="structrtnl__handle.html#a58397dc05569f5250b2bde1e40d2ddd2">fd</a> = -1;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aff3e26c0685ed303b1e8f1a0be29f96b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rtnl_dump_filter </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structrtnl__handle.html">rtnl_handle</a> *&#160;</td>
          <td class="paramname"><em>rth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="libnetlink_8h.html#ae75da56ead3fca07646a8636730ba7da">rtnl_filter_t</a>&#160;</td>
          <td class="paramname"><em>filter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="libnetlink_8c_source.html#l00264">264</a> of file <a class="el" href="libnetlink_8c_source.html">libnetlink.c</a>.</p>

<p>Referenced by <a class="el" href="ll__map_8c.html#a47c0fcafbcdec1f38b4631eec53c6456">ll_init_map()</a>.</p>
<div class="fragment"><div class="line">                                 {</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structrtnl__dump__filter__arg.html">rtnl_dump_filter_arg</a> a[2] = {</div>
<div class="line">        { .<a class="code" href="structrtnl__dump__filter__arg.html#a33960e30347201a38db1f64c61b7b5d3">filter</a> = <a class="code" href="structrtnl__dump__filter__arg.html#a33960e30347201a38db1f64c61b7b5d3">filter</a>, .arg1 = <a class="code" href="structrtnl__dump__filter__arg.html#ad4c302705f2eb368be9d74995d18733a">arg1</a>, },</div>
<div class="line">        { .filter = NULL,   .arg1 = NULL, },</div>
<div class="line">    };</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="include_2libnetlink_8h.html#ae8fcd359fa96ab84664ff0fab494369a">rtnl_dump_filter_l</a>(rth, a);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae8fcd359fa96ab84664ff0fab494369a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rtnl_dump_filter_l </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structrtnl__handle.html">rtnl_handle</a> *&#160;</td>
          <td class="paramname"><em>rth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structrtnl__dump__filter__arg.html">rtnl_dump_filter_arg</a> *&#160;</td>
          <td class="paramname"><em>arg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="libnetlink_8c_source.html#l00175">175</a> of file <a class="el" href="libnetlink_8c_source.html">libnetlink.c</a>.</p>

<p>Referenced by <a class="el" href="libnetlink_8h.html#aff3e26c0685ed303b1e8f1a0be29f96b">rtnl_dump_filter()</a>.</p>
<div class="fragment"><div class="line">                                                               {</div>
<div class="line">    <span class="keyword">struct </span>sockaddr_nl nladdr;</div>
<div class="line">    <span class="keyword">struct </span>iovec iov;</div>
<div class="line">    <span class="keyword">struct </span>msghdr msg = {</div>
<div class="line">        .msg_name = &amp;nladdr,</div>
<div class="line">        .msg_namelen = <span class="keyword">sizeof</span>(nladdr),</div>
<div class="line">        .msg_iov = &amp;iov,</div>
<div class="line">        .msg_iovlen = 1,</div>
<div class="line">    };</div>
<div class="line">    <span class="keywordtype">char</span> buf[16384];</div>
<div class="line"></div>
<div class="line">    iov.iov_base = buf;</div>
<div class="line">    <span class="keywordflow">while</span> (1) {</div>
<div class="line">        <span class="keywordtype">int</span> status;</div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structrtnl__dump__filter__arg.html">rtnl_dump_filter_arg</a> *a;</div>
<div class="line">        <span class="keywordtype">int</span> found_done = 0;</div>
<div class="line">        <span class="keywordtype">int</span> msglen = 0;</div>
<div class="line"></div>
<div class="line">        iov.iov_len = <span class="keyword">sizeof</span>(buf);</div>
<div class="line">        status = recvmsg(rth-&gt;<a class="code" href="structrtnl__handle.html#a58397dc05569f5250b2bde1e40d2ddd2">fd</a>, &amp;msg, 0);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (status &lt; 0) {</div>
<div class="line">            <span class="keywordflow">if</span> (errno == EINTR || errno == EAGAIN) {</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line">            }</div>
<div class="line">            fprintf(stderr, <span class="stringliteral">&quot;netlink receive error %s (%d)\n&quot;</span>,</div>
<div class="line">                    strerror(errno), errno);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (status == 0) {</div>
<div class="line">            fprintf(stderr, <span class="stringliteral">&quot;EOF on netlink\n&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">for</span> (a = arg; a-&gt;<a class="code" href="structrtnl__dump__filter__arg.html#a33960e30347201a38db1f64c61b7b5d3">filter</a>; a++) {</div>
<div class="line">            <span class="keyword">struct </span>nlmsghdr *h = (<span class="keyword">struct </span>nlmsghdr *)buf;</div>
<div class="line">            msglen = status;</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">while</span> (NLMSG_OK(h, msglen)) {</div>
<div class="line">                <span class="keywordtype">int</span> err;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span> (nladdr.nl_pid != 0 ||</div>
<div class="line">                        h-&gt;nlmsg_pid != rth-&gt;<a class="code" href="structrtnl__handle.html#a81dab3b60ac522e1b1809c4992288683">local</a>.nl_pid ||</div>
<div class="line">                        h-&gt;nlmsg_seq != rth-&gt;<a class="code" href="structrtnl__handle.html#a3e5b07ef999b7a331f91ae5065886871">dump</a>) {</div>
<div class="line">                    <span class="keywordflow">goto</span> skip_it;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span> (h-&gt;nlmsg_type == NLMSG_DONE) {</div>
<div class="line">                    found_done = 1;</div>
<div class="line">                    <span class="keywordflow">break</span>; <span class="comment">/* process next filter */</span></div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">if</span> (h-&gt;nlmsg_type == NLMSG_ERROR) {</div>
<div class="line">                    <span class="keyword">struct </span>nlmsgerr *err = (<span class="keyword">struct </span>nlmsgerr *)NLMSG_DATA(h);</div>
<div class="line">                    <span class="keywordflow">if</span> (h-&gt;nlmsg_len &lt; NLMSG_LENGTH(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> nlmsgerr))) {</div>
<div class="line">                        fprintf(stderr,</div>
<div class="line">                                <span class="stringliteral">&quot;ERROR truncated\n&quot;</span>);</div>
<div class="line">                    } <span class="keywordflow">else</span> {</div>
<div class="line">                        errno = -err-&gt;error;</div>
<div class="line">                        perror(<span class="stringliteral">&quot;RTNETLINK answers&quot;</span>);</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">return</span> -1;</div>
<div class="line">                }</div>
<div class="line">                err = a-&gt;<a class="code" href="structrtnl__dump__filter__arg.html#a33960e30347201a38db1f64c61b7b5d3">filter</a>(&amp;nladdr, h, a-&gt;<a class="code" href="structrtnl__dump__filter__arg.html#ad4c302705f2eb368be9d74995d18733a">arg1</a>);</div>
<div class="line">                <span class="keywordflow">if</span> (err &lt; 0) {</div>
<div class="line">                    <span class="keywordflow">return</span> err;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">skip_it:</div>
<div class="line">                h = NLMSG_NEXT(h, msglen);</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (found_done) {</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (msg.msg_flags &amp; MSG_TRUNC) {</div>
<div class="line">            fprintf(stderr, <span class="stringliteral">&quot;Message truncated\n&quot;</span>);</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (msglen) {</div>
<div class="line">            fprintf(stderr, <span class="stringliteral">&quot;!!!Remnant of size %d\n&quot;</span>, msglen);</div>
<div class="line">            exit(1);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a27afc1b9833591d8deca9c2ad4fedd8f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rtnl_dump_request </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structrtnl__handle.html">rtnl_handle</a> *&#160;</td>
          <td class="paramname"><em>rth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>req</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="libnetlink_8c_source.html#l00152">152</a> of file <a class="el" href="libnetlink_8c_source.html">libnetlink.c</a>.</p>
<div class="fragment"><div class="line">                                                                             {</div>
<div class="line">    <span class="keyword">struct </span>nlmsghdr nlh;</div>
<div class="line">    <span class="keyword">struct </span>sockaddr_nl nladdr = { .nl_family = AF_NETLINK };</div>
<div class="line">    <span class="keyword">struct </span>iovec iov[2] = {</div>
<div class="line">        { .iov_base = &amp;nlh, .iov_len = <span class="keyword">sizeof</span>(nlh) },</div>
<div class="line">        { .iov_base = req, .iov_len = len }</div>
<div class="line">    };</div>
<div class="line">    <span class="keyword">struct </span>msghdr msg = {</div>
<div class="line">        .msg_name = &amp;nladdr,</div>
<div class="line">        .msg_namelen =  <span class="keyword">sizeof</span>(nladdr),</div>
<div class="line">        .msg_iov = iov,</div>
<div class="line">        .msg_iovlen = 2,</div>
<div class="line">    };</div>
<div class="line"></div>
<div class="line">    nlh.nlmsg_len = NLMSG_LENGTH(len);</div>
<div class="line">    nlh.nlmsg_type = type;</div>
<div class="line">    nlh.nlmsg_flags = NLM_F_DUMP|NLM_F_REQUEST;</div>
<div class="line">    nlh.nlmsg_pid = 0;</div>
<div class="line">    nlh.nlmsg_seq = rth-&gt;<a class="code" href="structrtnl__handle.html#a3e5b07ef999b7a331f91ae5065886871">dump</a> = ++rth-&gt;<a class="code" href="structrtnl__handle.html#a3b423eb6125d051d774c8d8303b08cf9">seq</a>;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> sendmsg(rth-&gt;<a class="code" href="structrtnl__handle.html#a58397dc05569f5250b2bde1e40d2ddd2">fd</a>, &amp;msg, 0);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aed667520bef1b7d60686a3c61e3cf038"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rtnl_from_file </td>
          <td>(</td>
          <td class="paramtype">FILE *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="libnetlink_8h.html#ae75da56ead3fca07646a8636730ba7da">rtnl_filter_t</a>&#160;</td>
          <td class="paramname"><em>handler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>jarg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="libnetlink_8c_source.html#l00472">472</a> of file <a class="el" href="libnetlink_8c_source.html">libnetlink.c</a>.</p>
<div class="fragment"><div class="line">                               {</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line">    <span class="keyword">struct </span>sockaddr_nl nladdr;</div>
<div class="line">    <span class="keywordtype">char</span>   buf[8192];</div>
<div class="line">    <span class="keyword">struct </span>nlmsghdr *h = (<span class="keywordtype">void</span> *)buf;</div>
<div class="line"></div>
<div class="line">    memset(&amp;nladdr, 0, <span class="keyword">sizeof</span>(nladdr));</div>
<div class="line">    nladdr.nl_family = AF_NETLINK;</div>
<div class="line">    nladdr.nl_pid = 0;</div>
<div class="line">    nladdr.nl_groups = 0;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">while</span> (1) {</div>
<div class="line">        <span class="keywordtype">int</span> err, len;</div>
<div class="line">        <span class="keywordtype">int</span> l;</div>
<div class="line"></div>
<div class="line">        status = fread(&amp;buf, 1, <span class="keyword">sizeof</span>(*h), rtnl);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (status &lt; 0) {</div>
<div class="line">            <span class="keywordflow">if</span> (errno == EINTR) {</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line">            }</div>
<div class="line">            perror(<span class="stringliteral">&quot;rtnl_from_file: fread&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (status == 0) {</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        len = h-&gt;nlmsg_len;</div>
<div class="line">        l = len - <span class="keyword">sizeof</span>(*h);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (l&lt;0 || len&gt;<span class="keyword">sizeof</span>(buf)) {</div>
<div class="line">            fprintf(stderr, <span class="stringliteral">&quot;!!!malformed message: len=%d @%lu\n&quot;</span>,</div>
<div class="line">                    len, ftell(rtnl));</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        status = fread(NLMSG_DATA(h), 1, NLMSG_ALIGN(l), rtnl);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (status &lt; 0) {</div>
<div class="line">            perror(<span class="stringliteral">&quot;rtnl_from_file: fread&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (status &lt; l) {</div>
<div class="line">            fprintf(stderr, <span class="stringliteral">&quot;rtnl-from_file: truncated message\n&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        err = handler(&amp;nladdr, h, jarg);</div>
<div class="line">        <span class="keywordflow">if</span> (err &lt; 0) {</div>
<div class="line">            <span class="keywordflow">return</span> err;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aacc7a3663568d47caf34665e570d28f0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rtnl_listen </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structrtnl__handle.html">rtnl_handle</a> *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="libnetlink_8h.html#ae75da56ead3fca07646a8636730ba7da">rtnl_filter_t</a>&#160;</td>
          <td class="paramname"><em>handler</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>jarg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="libnetlink_8c_source.html#l00395">395</a> of file <a class="el" href="libnetlink_8c_source.html">libnetlink.c</a>.</p>
<div class="fragment"><div class="line">                            {</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line">    <span class="keyword">struct </span>nlmsghdr *h;</div>
<div class="line">    <span class="keyword">struct </span>sockaddr_nl nladdr;</div>
<div class="line">    <span class="keyword">struct </span>iovec iov;</div>
<div class="line">    <span class="keyword">struct </span>msghdr msg = {</div>
<div class="line">        .msg_name = &amp;nladdr,</div>
<div class="line">        .msg_namelen = <span class="keyword">sizeof</span>(nladdr),</div>
<div class="line">        .msg_iov = &amp;iov,</div>
<div class="line">        .msg_iovlen = 1,</div>
<div class="line">    };</div>
<div class="line">    <span class="keywordtype">char</span>   buf[8192];</div>
<div class="line"></div>
<div class="line">    memset(&amp;nladdr, 0, <span class="keyword">sizeof</span>(nladdr));</div>
<div class="line">    nladdr.nl_family = AF_NETLINK;</div>
<div class="line">    nladdr.nl_pid = 0;</div>
<div class="line">    nladdr.nl_groups = 0;</div>
<div class="line"></div>
<div class="line">    iov.iov_base = buf;</div>
<div class="line">    <span class="keywordflow">while</span> (1) {</div>
<div class="line">        iov.iov_len = <span class="keyword">sizeof</span>(buf);</div>
<div class="line">        status = recvmsg(rtnl-&gt;fd, &amp;msg, 0);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (status &lt; 0) {</div>
<div class="line">            <span class="keywordflow">if</span> (errno == EINTR || errno == EAGAIN) {</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line">            }</div>
<div class="line">            fprintf(stderr, <span class="stringliteral">&quot;netlink receive error %s (%d)\n&quot;</span>,</div>
<div class="line">                    strerror(errno), errno);</div>
<div class="line">            <span class="keywordflow">if</span> (errno == ENOBUFS) {</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (status == 0) {</div>
<div class="line">            fprintf(stderr, <span class="stringliteral">&quot;EOF on netlink\n&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (msg.msg_namelen != <span class="keyword">sizeof</span>(nladdr)) {</div>
<div class="line">            fprintf(stderr, <span class="stringliteral">&quot;Sender address length == %d\n&quot;</span>, msg.msg_namelen);</div>
<div class="line">            exit(1);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">for</span> (h = (<span class="keyword">struct</span> nlmsghdr *)buf; status &gt;= <span class="keyword">sizeof</span>(*h); ) {</div>
<div class="line">            <span class="keywordtype">int</span> err;</div>
<div class="line">            <span class="keywordtype">int</span> len = h-&gt;nlmsg_len;</div>
<div class="line">            <span class="keywordtype">int</span> l = len - <span class="keyword">sizeof</span>(*h);</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">if</span> (l&lt;0 || len&gt;status) {</div>
<div class="line">                <span class="keywordflow">if</span> (msg.msg_flags &amp; MSG_TRUNC) {</div>
<div class="line">                    fprintf(stderr, <span class="stringliteral">&quot;Truncated message\n&quot;</span>);</div>
<div class="line">                    <span class="keywordflow">return</span> -1;</div>
<div class="line">                }</div>
<div class="line">                fprintf(stderr, <span class="stringliteral">&quot;!!!malformed message: len=%d\n&quot;</span>, len);</div>
<div class="line">                exit(1);</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            err = handler(&amp;nladdr, h, jarg);</div>
<div class="line">            <span class="keywordflow">if</span> (err &lt; 0) {</div>
<div class="line">                <span class="keywordflow">return</span> err;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            status -= NLMSG_ALIGN(len);</div>
<div class="line">            h = (<span class="keyword">struct </span>nlmsghdr *)((<span class="keywordtype">char</span> *)h + NLMSG_ALIGN(len));</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (msg.msg_flags &amp; MSG_TRUNC) {</div>
<div class="line">            fprintf(stderr, <span class="stringliteral">&quot;Message truncated\n&quot;</span>);</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (status) {</div>
<div class="line">            fprintf(stderr, <span class="stringliteral">&quot;!!!Remnant of size %d\n&quot;</span>, status);</div>
<div class="line">            exit(1);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af6a834b458ad515cfe591cd720b5a3fd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rtnl_open </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structrtnl__handle.html">rtnl_handle</a> *&#160;</td>
          <td class="paramname"><em>rth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>subscriptions</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="libnetlink_8c_source.html#l00085">85</a> of file <a class="el" href="libnetlink_8c_source.html">libnetlink.c</a>.</p>
<div class="fragment"><div class="line">                                                               {</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="include_2libnetlink_8h.html#adcef0338bcf67064f61e984ea6542a4f">rtnl_open_byproto</a>(rth, subscriptions, NETLINK_ROUTE);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="adcef0338bcf67064f61e984ea6542a4f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rtnl_open_byproto </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structrtnl__handle.html">rtnl_handle</a> *&#160;</td>
          <td class="paramname"><em>rth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>subscriptions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>protocol</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="libnetlink_8c_source.html#l00037">37</a> of file <a class="el" href="libnetlink_8c_source.html">libnetlink.c</a>.</p>

<p>Referenced by <a class="el" href="libnetlink_8h.html#af6a834b458ad515cfe591cd720b5a3fd">rtnl_open()</a>.</p>
<div class="fragment"><div class="line">                                    {</div>
<div class="line">    socklen_t addr_len;</div>
<div class="line">    <span class="keywordtype">int</span> sndbuf = 32768;</div>
<div class="line"></div>
<div class="line">    memset(rth, 0, <span class="keyword">sizeof</span>(*rth));</div>
<div class="line"></div>
<div class="line">    rth-&gt;<a class="code" href="structrtnl__handle.html#a58397dc05569f5250b2bde1e40d2ddd2">fd</a> = socket(AF_NETLINK, SOCK_RAW, protocol);</div>
<div class="line">    <span class="keywordflow">if</span> (rth-&gt;<a class="code" href="structrtnl__handle.html#a58397dc05569f5250b2bde1e40d2ddd2">fd</a> &lt; 0) {</div>
<div class="line">        perror(<span class="stringliteral">&quot;Cannot open netlink socket&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (setsockopt(rth-&gt;<a class="code" href="structrtnl__handle.html#a58397dc05569f5250b2bde1e40d2ddd2">fd</a>,SOL_SOCKET,SO_SNDBUF,&amp;sndbuf,<span class="keyword">sizeof</span>(sndbuf)) &lt; 0) {</div>
<div class="line">        perror(<span class="stringliteral">&quot;SO_SNDBUF&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (setsockopt(rth-&gt;<a class="code" href="structrtnl__handle.html#a58397dc05569f5250b2bde1e40d2ddd2">fd</a>,SOL_SOCKET,SO_RCVBUF,&amp;<a class="code" href="include_2libnetlink_8h.html#ac8965cf584a82cef83405486ac542f39">rcvbuf</a>,<span class="keyword">sizeof</span>(<a class="code" href="include_2libnetlink_8h.html#ac8965cf584a82cef83405486ac542f39">rcvbuf</a>)) &lt; 0) {</div>
<div class="line">        perror(<span class="stringliteral">&quot;SO_RCVBUF&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    memset(&amp;rth-&gt;<a class="code" href="structrtnl__handle.html#a81dab3b60ac522e1b1809c4992288683">local</a>, 0, <span class="keyword">sizeof</span>(rth-&gt;<a class="code" href="structrtnl__handle.html#a81dab3b60ac522e1b1809c4992288683">local</a>));</div>
<div class="line">    rth-&gt;<a class="code" href="structrtnl__handle.html#a81dab3b60ac522e1b1809c4992288683">local</a>.nl_family = AF_NETLINK;</div>
<div class="line">    rth-&gt;<a class="code" href="structrtnl__handle.html#a81dab3b60ac522e1b1809c4992288683">local</a>.nl_groups = subscriptions;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (bind(rth-&gt;<a class="code" href="structrtnl__handle.html#a58397dc05569f5250b2bde1e40d2ddd2">fd</a>, (<span class="keyword">struct</span> sockaddr *)&amp;rth-&gt;<a class="code" href="structrtnl__handle.html#a81dab3b60ac522e1b1809c4992288683">local</a>, <span class="keyword">sizeof</span>(rth-&gt;<a class="code" href="structrtnl__handle.html#a81dab3b60ac522e1b1809c4992288683">local</a>)) &lt; 0) {</div>
<div class="line">        perror(<span class="stringliteral">&quot;Cannot bind netlink socket&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line">    addr_len = <span class="keyword">sizeof</span>(rth-&gt;<a class="code" href="structrtnl__handle.html#a81dab3b60ac522e1b1809c4992288683">local</a>);</div>
<div class="line">    <span class="keywordflow">if</span> (getsockname(rth-&gt;<a class="code" href="structrtnl__handle.html#a58397dc05569f5250b2bde1e40d2ddd2">fd</a>, (<span class="keyword">struct</span> sockaddr *)&amp;rth-&gt;<a class="code" href="structrtnl__handle.html#a81dab3b60ac522e1b1809c4992288683">local</a>, &amp;addr_len) &lt; 0) {</div>
<div class="line">        perror(<span class="stringliteral">&quot;Cannot getsockname&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (addr_len != <span class="keyword">sizeof</span>(rth-&gt;<a class="code" href="structrtnl__handle.html#a81dab3b60ac522e1b1809c4992288683">local</a>)) {</div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;Wrong address length %d\n&quot;</span>, addr_len);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (rth-&gt;<a class="code" href="structrtnl__handle.html#a81dab3b60ac522e1b1809c4992288683">local</a>.nl_family != AF_NETLINK) {</div>
<div class="line">        fprintf(stderr, <span class="stringliteral">&quot;Wrong address family %d\n&quot;</span>, rth-&gt;<a class="code" href="structrtnl__handle.html#a81dab3b60ac522e1b1809c4992288683">local</a>.nl_family);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line">    rth-&gt;<a class="code" href="structrtnl__handle.html#a3b423eb6125d051d774c8d8303b08cf9">seq</a> = time(NULL);</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a487fd362854361404e0f1c9cab663d85"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rtnl_send </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structrtnl__handle.html">rtnl_handle</a> *&#160;</td>
          <td class="paramname"><em>rth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="libnetlink_8c_source.html#l00113">113</a> of file <a class="el" href="libnetlink_8c_source.html">libnetlink.c</a>.</p>
<div class="fragment"><div class="line">                                                                 {</div>
<div class="line">    <span class="keywordflow">return</span> send(rth-&gt;<a class="code" href="structrtnl__handle.html#a58397dc05569f5250b2bde1e40d2ddd2">fd</a>, buf, len, 0);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af30370141d4ec3e4b6c3bce938e89992"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rtnl_send_check </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structrtnl__handle.html">rtnl_handle</a> *&#160;</td>
          <td class="paramname"><em>rth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname">&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="libnetlink_8c_source.html#l00117">117</a> of file <a class="el" href="libnetlink_8c_source.html">libnetlink.c</a>.</p>
<div class="fragment"><div class="line">                                                                       {</div>
<div class="line">    <span class="keyword">struct </span>nlmsghdr *h;</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line">    <span class="keywordtype">char</span> resp[1024];</div>
<div class="line"></div>
<div class="line">    status = send(rth-&gt;<a class="code" href="structrtnl__handle.html#a58397dc05569f5250b2bde1e40d2ddd2">fd</a>, buf, len, 0);</div>
<div class="line">    <span class="keywordflow">if</span> (status &lt; 0) {</div>
<div class="line">        <span class="keywordflow">return</span> status;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Check for immediate errors */</span></div>
<div class="line">    status = recv(rth-&gt;<a class="code" href="structrtnl__handle.html#a58397dc05569f5250b2bde1e40d2ddd2">fd</a>, resp, <span class="keyword">sizeof</span>(resp), MSG_DONTWAIT|MSG_PEEK);</div>
<div class="line">    <span class="keywordflow">if</span> (status &lt; 0) {</div>
<div class="line">        <span class="keywordflow">if</span> (errno == EAGAIN) {</div>
<div class="line">            <span class="keywordflow">return</span> 0;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span> (h = (<span class="keyword">struct</span> nlmsghdr *)resp; NLMSG_OK(h, status);</div>
<div class="line">            h = NLMSG_NEXT(h, status)) {</div>
<div class="line">        <span class="keywordflow">if</span> (h-&gt;nlmsg_type == NLMSG_ERROR) {</div>
<div class="line">            <span class="keyword">struct </span>nlmsgerr *err = (<span class="keyword">struct </span>nlmsgerr *)NLMSG_DATA(h);</div>
<div class="line">            <span class="keywordflow">if</span> (h-&gt;nlmsg_len &lt; NLMSG_LENGTH(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> nlmsgerr))) {</div>
<div class="line">                fprintf(stderr, <span class="stringliteral">&quot;ERROR truncated\n&quot;</span>);</div>
<div class="line">            } <span class="keywordflow">else</span> {</div>
<div class="line">                errno = -err-&gt;error;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="accbb65e468ec1fe95dca844dcdb03493"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rtnl_talk </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structrtnl__handle.html">rtnl_handle</a> *&#160;</td>
          <td class="paramname"><em>rtnl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct nlmsghdr *&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pid_t&#160;</td>
          <td class="paramname"><em>peer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>groups</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct nlmsghdr *&#160;</td>
          <td class="paramname"><em>answer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="libnetlink_8c_source.html#l00275">275</a> of file <a class="el" href="libnetlink_8c_source.html">libnetlink.c</a>.</p>

<p>Referenced by <a class="el" href="group___l_i_b-_i_f_a_c_e.html#gae4744405b8a043979aa4ea1cfde174ef">create_kernmac()</a>, <a class="el" href="group___l_i_b-_i_f_a_c_e.html#gad4b0322139d45ba2b60e21a639fa9c29">create_kernvlan()</a>, <a class="el" href="group___l_i_b-_i_f_a_c_e.html#ga67dcdb7d1138121755d36d6e3f9e7196">set_interface_addr()</a>, <a class="el" href="group___l_i_b-_i_f_a_c_e.html#ga483fe40be559db7e6c35d1fac39f4951">set_interface_flags()</a>, <a class="el" href="group___l_i_b-_i_f_a_c_e.html#ga2f3e0de7dc564bb0a51656e0be0d82df">set_interface_ipaddr()</a>, and <a class="el" href="group___l_i_b-_i_f_a_c_e.html#gaf84e9152d0c6c803c75b6f47772a22ba">set_interface_name()</a>.</p>
<div class="fragment"><div class="line">                                                        {</div>
<div class="line">    <span class="keywordtype">int</span> status;</div>
<div class="line">    <span class="keywordtype">unsigned</span> seq;</div>
<div class="line">    <span class="keyword">struct </span>nlmsghdr *h;</div>
<div class="line">    <span class="keyword">struct </span>sockaddr_nl nladdr;</div>
<div class="line">    <span class="keyword">struct </span>iovec iov = {</div>
<div class="line">        .iov_base = (<span class="keywordtype">void</span> *) n,</div>
<div class="line">        .iov_len = n-&gt;nlmsg_len</div>
<div class="line">    };</div>
<div class="line">    <span class="keyword">struct </span>msghdr msg = {</div>
<div class="line">        .msg_name = &amp;nladdr,</div>
<div class="line">        .msg_namelen = <span class="keyword">sizeof</span>(nladdr),</div>
<div class="line">        .msg_iov = &amp;iov,</div>
<div class="line">        .msg_iovlen = 1,</div>
<div class="line">    };</div>
<div class="line">    <span class="keywordtype">char</span>   buf[16384];</div>
<div class="line"></div>
<div class="line">    memset(&amp;nladdr, 0, <span class="keyword">sizeof</span>(nladdr));</div>
<div class="line">    nladdr.nl_family = AF_NETLINK;</div>
<div class="line">    nladdr.nl_pid = peer;</div>
<div class="line">    nladdr.nl_groups = groups;</div>
<div class="line"></div>
<div class="line">    n-&gt;nlmsg_seq = seq = ++rtnl-&gt;<a class="code" href="structrtnl__handle.html#a3b423eb6125d051d774c8d8303b08cf9">seq</a>;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (answer == NULL) {</div>
<div class="line">        n-&gt;nlmsg_flags |= NLM_F_ACK;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    status = sendmsg(rtnl-&gt;<a class="code" href="structrtnl__handle.html#a58397dc05569f5250b2bde1e40d2ddd2">fd</a>, &amp;msg, 0);</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span> (status &lt; 0) {</div>
<div class="line">        perror(<span class="stringliteral">&quot;Cannot talk to rtnetlink&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    memset(buf,0,<span class="keyword">sizeof</span>(buf));</div>
<div class="line"></div>
<div class="line">    iov.iov_base = buf;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">while</span> (1) {</div>
<div class="line">        iov.iov_len = <span class="keyword">sizeof</span>(buf);</div>
<div class="line">        status = recvmsg(rtnl-&gt;<a class="code" href="structrtnl__handle.html#a58397dc05569f5250b2bde1e40d2ddd2">fd</a>, &amp;msg, 0);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (status &lt; 0) {</div>
<div class="line">            <span class="keywordflow">if</span> (errno == EINTR || errno == EAGAIN) {</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line">            }</div>
<div class="line">            fprintf(stderr, <span class="stringliteral">&quot;netlink receive error %s (%d)\n&quot;</span>,</div>
<div class="line">                    strerror(errno), errno);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (status == 0) {</div>
<div class="line">            fprintf(stderr, <span class="stringliteral">&quot;EOF on netlink\n&quot;</span>);</div>
<div class="line">            <span class="keywordflow">return</span> -1;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (msg.msg_namelen != <span class="keyword">sizeof</span>(nladdr)) {</div>
<div class="line">            fprintf(stderr, <span class="stringliteral">&quot;sender address length == %d\n&quot;</span>, msg.msg_namelen);</div>
<div class="line">            exit(1);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">for</span> (h = (<span class="keyword">struct</span> nlmsghdr *)buf; status &gt;= <span class="keyword">sizeof</span>(*h); ) {</div>
<div class="line">            <span class="keywordtype">int</span> len = h-&gt;nlmsg_len;</div>
<div class="line">            <span class="keywordtype">int</span> l = len - <span class="keyword">sizeof</span>(*h);</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">if</span> (l &lt; 0 || len&gt;status) {</div>
<div class="line">                <span class="keywordflow">if</span> (msg.msg_flags &amp; MSG_TRUNC) {</div>
<div class="line">                    fprintf(stderr, <span class="stringliteral">&quot;Truncated message\n&quot;</span>);</div>
<div class="line">                    <span class="keywordflow">return</span> -1;</div>
<div class="line">                }</div>
<div class="line">                fprintf(stderr, <span class="stringliteral">&quot;!!!malformed message: len=%d\n&quot;</span>, len);</div>
<div class="line">                exit(1);</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">if</span> (nladdr.nl_pid != peer ||</div>
<div class="line">                    h-&gt;nlmsg_pid != rtnl-&gt;<a class="code" href="structrtnl__handle.html#a81dab3b60ac522e1b1809c4992288683">local</a>.nl_pid ||</div>
<div class="line">                    h-&gt;nlmsg_seq != seq) {</div>
<div class="line">                <span class="comment">/* Don&#39;t forget to skip that message. */</span></div>
<div class="line">                status -= NLMSG_ALIGN(len);</div>
<div class="line">                h = (<span class="keyword">struct </span>nlmsghdr *)((<span class="keywordtype">char</span> *)h + NLMSG_ALIGN(len));</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            <span class="keywordflow">if</span> (h-&gt;nlmsg_type == NLMSG_ERROR) {</div>
<div class="line">                <span class="keyword">struct </span>nlmsgerr *err = (<span class="keyword">struct </span>nlmsgerr *)NLMSG_DATA(h);</div>
<div class="line">                <span class="keywordflow">if</span> (l &lt; <span class="keyword">sizeof</span>(<span class="keyword">struct</span> nlmsgerr)) {</div>
<div class="line">                    fprintf(stderr, <span class="stringliteral">&quot;ERROR truncated\n&quot;</span>);</div>
<div class="line">                } <span class="keywordflow">else</span> {</div>
<div class="line">                    <span class="keywordflow">if</span> (!err-&gt;error) {</div>
<div class="line">                        <span class="keywordflow">if</span> (answer) {</div>
<div class="line">                            memcpy(answer, h, h-&gt;nlmsg_len);</div>
<div class="line">                        }</div>
<div class="line">                        <span class="keywordflow">return</span> 0;</div>
<div class="line">                    }</div>
<div class="line"></div>
<div class="line">                    fprintf(stderr, <span class="stringliteral">&quot;RTNETLINK answers: %s\n&quot;</span>, strerror(-err-&gt;error));</div>
<div class="line">                    errno = -err-&gt;error;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">return</span> -1;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">if</span> (answer) {</div>
<div class="line">                memcpy(answer, h, h-&gt;nlmsg_len);</div>
<div class="line">                <span class="keywordflow">return</span> 0;</div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            fprintf(stderr, <span class="stringliteral">&quot;Unexpected reply!!!\n&quot;</span>);</div>
<div class="line"></div>
<div class="line">            status -= NLMSG_ALIGN(len);</div>
<div class="line">            h = (<span class="keyword">struct </span>nlmsghdr *)((<span class="keywordtype">char</span> *)h + NLMSG_ALIGN(len));</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (msg.msg_flags &amp; MSG_TRUNC) {</div>
<div class="line">            fprintf(stderr, <span class="stringliteral">&quot;Message truncated\n&quot;</span>);</div>
<div class="line">            <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (status) {</div>
<div class="line">            fprintf(stderr, <span class="stringliteral">&quot;!!!Remnant of size %d\n&quot;</span>, status);</div>
<div class="line">            exit(1);</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5d89c9b26f1bf5a091e6296298df671e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rtnl_wilddump_request </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structrtnl__handle.html">rtnl_handle</a> *&#160;</td>
          <td class="paramname"><em>rth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fam</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="libnetlink_8c_source.html#l00089">89</a> of file <a class="el" href="libnetlink_8c_source.html">libnetlink.c</a>.</p>

<p>Referenced by <a class="el" href="ll__map_8c.html#a47c0fcafbcdec1f38b4631eec53c6456">ll_init_map()</a>.</p>
<div class="fragment"><div class="line">                                                                         {</div>
<div class="line">    <span class="keyword">struct </span>{</div>
<div class="line">        <span class="keyword">struct </span>nlmsghdr nlh;</div>
<div class="line">        <span class="keyword">struct </span>rtgenmsg g;</div>
<div class="line">        __u16 align_rta;    <span class="comment">/* attribute has to be 32bit aligned */</span></div>
<div class="line">        <span class="keyword">struct </span>rtattr ext_req;</div>
<div class="line">        __u32 ext_filter_mask;</div>
<div class="line">    } req;</div>
<div class="line"></div>
<div class="line">    memset(&amp;req, 0, <span class="keyword">sizeof</span>(req));</div>
<div class="line">    req.nlh.nlmsg_len = <span class="keyword">sizeof</span>(req);</div>
<div class="line">    req.nlh.nlmsg_type = type;</div>
<div class="line">    req.nlh.nlmsg_flags = NLM_F_DUMP|NLM_F_REQUEST;</div>
<div class="line">    req.nlh.nlmsg_pid = 0;</div>
<div class="line">    req.nlh.nlmsg_seq = rth-&gt;<a class="code" href="structrtnl__handle.html#a3e5b07ef999b7a331f91ae5065886871">dump</a> = ++rth-&gt;<a class="code" href="structrtnl__handle.html#a3b423eb6125d051d774c8d8303b08cf9">seq</a>;</div>
<div class="line">    req.g.rtgen_family = family;</div>
<div class="line"></div>
<div class="line">    req.ext_req.rta_type = IFLA_EXT_MASK;</div>
<div class="line">    req.ext_req.rta_len = RTA_LENGTH(<span class="keyword">sizeof</span>(__u32));</div>
<div class="line">    req.ext_filter_mask = RTEXT_FILTER_VF;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">return</span> send(rth-&gt;<a class="code" href="structrtnl__handle.html#a58397dc05569f5250b2bde1e40d2ddd2">fd</a>, (<span class="keywordtype">void</span> *)&amp;req, <span class="keyword">sizeof</span>(req), 0);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="ac8965cf584a82cef83405486ac542f39"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rcvbuf</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="libnetlink_8c_source.html#l00028">28</a> of file <a class="el" href="libnetlink_8c_source.html">libnetlink.c</a>.</p>

<p>Referenced by <a class="el" href="libnetlink_8h.html#adcef0338bcf67064f61e984ea6542a4f">rtnl_open_byproto()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_45b5b7f8725b3e08d67e35d5901722db.html">src</a></li><li class="navelem"><a class="el" href="dir_5462e482004ab0bc7a6f016df927262f.html">libnetlink</a></li><li class="navelem"><a class="el" href="dir_e14c87ab7e723098b5f073a64ab1a832.html">include</a></li><li class="navelem"><a class="el" href="include_2libnetlink_8h.html">libnetlink.h</a></li>
    <li class="footer">Generated on Sun Oct 13 2013 08:41:29 for DTS Application Library by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.2 </li>
  </ul>
</div>
</body>
</html>
