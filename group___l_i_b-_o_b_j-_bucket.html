<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>DTS Application Library: Hashed bucket linked lists of referenced objects</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">DTS Application Library
   &#160;<span id="projectnumber">0.2.3</span>
   </div>
   <div id="projectbrief">Application library containing referenced objects and interfaces to common libraries</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group___l_i_b-_o_b_j-_bucket.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#files">Files</a> &#124;
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Hashed bucket linked lists of referenced objects<div class="ingroups"><a class="el" href="group___l_i_b-_o_b_j.html">Referenced Lockable Objects</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>Store references in and retrive from linked lists based on a hash.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="files"></a>
Files</h2></td></tr>
<tr class="memitem:refobj_8c"><td class="memItemLeft" align="right" valign="top">file &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="refobj_8c.html">refobj.c</a></td></tr>
<tr class="memdesc:refobj_8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Referenced Lockable Objects. <br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structblist__obj.html">blist_obj</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Entry in a bucket list.  <a href="structblist__obj.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbucket__list.html">bucket_list</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bucket list, hold hashed objects in buckets.  <a href="structbucket__list.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structbucket__loop.html">bucket_loop</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Bucket iterator.  <a href="structbucket__loop.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:gabf1358cda7e434b44a959039e6fabfce"><td class="memItemLeft" align="right" valign="top">typedef int32_t(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___l_i_b-_o_b_j-_bucket.html#gabf1358cda7e434b44a959039e6fabfce">blisthash</a> )(const void *, int)</td></tr>
<tr class="memdesc:gabf1358cda7e434b44a959039e6fabfce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Callback used to calculate the hash of a structure.  <a href="#gabf1358cda7e434b44a959039e6fabfce">More...</a><br/></td></tr>
<tr class="separator:gabf1358cda7e434b44a959039e6fabfce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga35996929b1a3aae886be2e45d1cadfec"><td class="memItemLeft" align="right" valign="top">typedef void(*&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___l_i_b-_o_b_j-_bucket.html#ga35996929b1a3aae886be2e45d1cadfec">blist_cb</a> )(void *, void *)</td></tr>
<tr class="memdesc:ga35996929b1a3aae886be2e45d1cadfec"><td class="mdescLeft">&#160;</td><td class="mdescRight">This callback is run on each entry in a list.  <a href="#ga35996929b1a3aae886be2e45d1cadfec">More...</a><br/></td></tr>
<tr class="separator:ga35996929b1a3aae886be2e45d1cadfec"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga504545b538666017fe0d41e428310341"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___l_i_b-_o_b_j-_bucket.html#ga504545b538666017fe0d41e428310341">create_bucketlist</a> (int bitmask, <a class="el" href="group___l_i_b-_o_b_j-_bucket.html#gabf1358cda7e434b44a959039e6fabfce">blisthash</a> hash_function)</td></tr>
<tr class="separator:ga504545b538666017fe0d41e428310341"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga63890af5b9f14017f9face6f7255a955"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___l_i_b-_o_b_j-_bucket.html#ga63890af5b9f14017f9face6f7255a955">addtobucket</a> (struct <a class="el" href="structbucket__list.html">bucket_list</a> *blist, void *data)</td></tr>
<tr class="memdesc:ga63890af5b9f14017f9face6f7255a955"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add a reference to the bucketlist.  <a href="#ga63890af5b9f14017f9face6f7255a955">More...</a><br/></td></tr>
<tr class="separator:ga63890af5b9f14017f9face6f7255a955"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga610e2d3a459838f394de26e8d1320253"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___l_i_b-_o_b_j-_bucket.html#ga610e2d3a459838f394de26e8d1320253">remove_bucket_item</a> (struct <a class="el" href="structbucket__list.html">bucket_list</a> *blist, void *data)</td></tr>
<tr class="memdesc:ga610e2d3a459838f394de26e8d1320253"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove and unreference a item from the list.  <a href="#ga610e2d3a459838f394de26e8d1320253">More...</a><br/></td></tr>
<tr class="separator:ga610e2d3a459838f394de26e8d1320253"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf312a26de37ad9594212c466a706c776"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___l_i_b-_o_b_j-_bucket.html#gaf312a26de37ad9594212c466a706c776">bucket_list_cnt</a> (struct <a class="el" href="structbucket__list.html">bucket_list</a> *blist)</td></tr>
<tr class="memdesc:gaf312a26de37ad9594212c466a706c776"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return number of items in the list.  <a href="#gaf312a26de37ad9594212c466a706c776">More...</a><br/></td></tr>
<tr class="separator:gaf312a26de37ad9594212c466a706c776"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadcbb1534c836ba15aa2acf066bd5fff7"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___l_i_b-_o_b_j-_bucket.html#gadcbb1534c836ba15aa2acf066bd5fff7">bucket_list_find_key</a> (struct <a class="el" href="structbucket__list.html">bucket_list</a> *blist, const void *key)</td></tr>
<tr class="memdesc:gadcbb1534c836ba15aa2acf066bd5fff7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find and return a reference to a item matching supplied key.  <a href="#gadcbb1534c836ba15aa2acf066bd5fff7">More...</a><br/></td></tr>
<tr class="separator:gadcbb1534c836ba15aa2acf066bd5fff7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga55c344ef8eb37a0a76eac1de01d36349"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___l_i_b-_o_b_j-_bucket.html#ga55c344ef8eb37a0a76eac1de01d36349">bucketlist_callback</a> (struct <a class="el" href="structbucket__list.html">bucket_list</a> *blist, <a class="el" href="group___l_i_b-_o_b_j-_bucket.html#ga35996929b1a3aae886be2e45d1cadfec">blist_cb</a> callback, void *data2)</td></tr>
<tr class="memdesc:ga55c344ef8eb37a0a76eac1de01d36349"><td class="mdescLeft">&#160;</td><td class="mdescRight">Run a callback function on all items in the list.  <a href="#ga55c344ef8eb37a0a76eac1de01d36349">More...</a><br/></td></tr>
<tr class="separator:ga55c344ef8eb37a0a76eac1de01d36349"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf05994d11e28a40271f80db3f3668852"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structbucket__loop.html">bucket_loop</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___l_i_b-_o_b_j-_bucket.html#gaf05994d11e28a40271f80db3f3668852">init_bucket_loop</a> (struct <a class="el" href="structbucket__list.html">bucket_list</a> *blist)</td></tr>
<tr class="memdesc:gaf05994d11e28a40271f80db3f3668852"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a bucket list iterator to safely iterate the list.  <a href="#gaf05994d11e28a40271f80db3f3668852">More...</a><br/></td></tr>
<tr class="separator:gaf05994d11e28a40271f80db3f3668852"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4dfa18d64062aae420d9d7ab1c9943d7"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___l_i_b-_o_b_j-_bucket.html#ga4dfa18d64062aae420d9d7ab1c9943d7">next_bucket_loop</a> (struct <a class="el" href="structbucket__loop.html">bucket_loop</a> *bloop)</td></tr>
<tr class="memdesc:ga4dfa18d64062aae420d9d7ab1c9943d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Return a reference to the next item in the list this could be the first item.  <a href="#ga4dfa18d64062aae420d9d7ab1c9943d7">More...</a><br/></td></tr>
<tr class="separator:ga4dfa18d64062aae420d9d7ab1c9943d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaab57f98566f9886d20cfa6229bd163a0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group___l_i_b-_o_b_j-_bucket.html#gaab57f98566f9886d20cfa6229bd163a0">remove_bucket_loop</a> (struct <a class="el" href="structbucket__loop.html">bucket_loop</a> *bloop)</td></tr>
<tr class="memdesc:gaab57f98566f9886d20cfa6229bd163a0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Safely remove a item from a list while iterating in a loop.  <a href="#gaab57f98566f9886d20cfa6229bd163a0">More...</a><br/></td></tr>
<tr class="separator:gaab57f98566f9886d20cfa6229bd163a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>Store references in and retrive from linked lists based on a hash. </p>
<p>Create a hashed bucket list.</p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="blists.html">Hashed Bucket Lists</a> </dd>
<dd>
<a class="el" href="group___l_i_b-_hash.html">Burtle Bob hash algorythim.</a></dd></dl>
<p>A bucket list is a ref obj the "list" element is a array of "bucket" entries each has a hash the default is to hash the memory when there is no call back </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000007">Todo:</a></b></dt><dd>Dont hash the memory supply a key perhaps a key array type. </dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>the hash must be calculated on immutable data. </dd></dl>
<dl class="section note"><dt>Note</dt><dd>a bucket list should only contain objects of the same type. </dd>
<dd>
Unreferencing the bucketlist will cause it to be emptied and freed when the count reaches 0. </dd></dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group___l_i_b-_o_b_j-_bucket.html#gabf1358cda7e434b44a959039e6fabfce" title="Callback used to calculate the hash of a structure. ">blisthash</a> </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">bitmask</td><td>Number of buckets to create 2^bitmask. </td></tr>
    <tr><td class="paramname">hash_function</td><td>Callback that returns the unique hash for a item this value must not change. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Reference to a empty bucket list. </dd></dl>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="ga35996929b1a3aae886be2e45d1cadfec"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void(* blist_cb)(void *, void *)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This callback is run on each entry in a list. </p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group___l_i_b-_o_b_j-_bucket.html#ga55c344ef8eb37a0a76eac1de01d36349" title="Run a callback function on all items in the list. ">bucketlist_callback()</a> </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">data</td><td>Reference held by the list. </td></tr>
    <tr><td class="paramname">data2</td><td>Reference to data supplied when calling bucketlist_callback. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="dtsapp_8h_source.html#l00278">278</a> of file <a class="el" href="dtsapp_8h_source.html">dtsapp.h</a>.</p>

</div>
</div>
<a class="anchor" id="gabf1358cda7e434b44a959039e6fabfce"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef int32_t(* blisthash)(const void *, int)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Callback used to calculate the hash of a structure. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">data</td><td>Data or key to calculate hash from. </td></tr>
    <tr><td class="paramname">key</td><td>Key if set to non zero data supplied is the key not data. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Hash for the Reference. </dd></dl>

<p>Definition at line <a class="el" href="dtsapp_8h_source.html#l00271">271</a> of file <a class="el" href="dtsapp_8h_source.html">dtsapp.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga63890af5b9f14017f9face6f7255a955"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int addtobucket </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structbucket__list.html">bucket_list</a> *&#160;</td>
          <td class="paramname"><em>blist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Add a reference to the bucketlist. </p>
<p>Create a entry in the list for reference obtained from data. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">blist</td><td>Bucket list to add too. </td></tr>
    <tr><td class="paramname">data</td><td>to obtain a reference too and add to the list. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>0 on failure 1 on success. </dd></dl>

<p>Definition at line <a class="el" href="refobj_8c_source.html#l00428">428</a> of file <a class="el" href="refobj_8c_source.html">refobj.c</a>.</p>

<p>References <a class="el" href="structbucket__list.html#a27d5a7bc37cf67aac5131f3ae21c1893">bucket_list::bucketbits</a>, <a class="el" href="structbucket__list.html#a59345370e4c9bbc627770d4b0b6aa30e">bucket_list::count</a>, <a class="el" href="structref__obj.html#a4725a0b14472b6571c3901ccc71bae08">ref_obj::data</a>, <a class="el" href="structblist__obj.html#a6fa1ad5e6615e1e7fd15743800d9e78f">blist_obj::data</a>, <a class="el" href="structblist__obj.html#a10e72984c2a9c6a3de07586c5d8a79c5">blist_obj::hash</a>, <a class="el" href="structbucket__list.html#a39f6f08d43f8c26616cac2a37ae2856c">bucket_list::list</a>, <a class="el" href="structbucket__list.html#a55970b0d3a70126a24caee83bd6889d5">bucket_list::locks</a>, <a class="el" href="structblist__obj.html#aa2ccd4f4869b457fcca8ada6042bdb96">blist_obj::next</a>, <a class="el" href="group___l_i_b-_o_b_j.html#ga4af4ae14c4a3e9f3037a09237bcfeae3">objlock()</a>, <a class="el" href="group___l_i_b-_o_b_j.html#ga3a67a6d45e39f530beb6e45b6b7e7d3b">objref()</a>, <a class="el" href="group___l_i_b-_o_b_j.html#ga8c73b68730aa4452357e84af27e00008">objunlock()</a>, <a class="el" href="group___l_i_b-_o_b_j.html#ga88a966a194cdf36fe9b5be0917ce86d9">objunref()</a>, <a class="el" href="structblist__obj.html#a61ae75a0a5d05916a302d365e7ca470a">blist_obj::prev</a>, <a class="el" href="group___l_i_b-_o_b_j.html#ga0fbd2bea995f35a552a2a502e1119977">refobj_offset</a>, and <a class="el" href="structbucket__list.html#a38a8dcfedb85da3556814085382f2bea">bucket_list::version</a>.</p>

<p>Referenced by <a class="el" href="group___l_i_b-_r_a_d_i_u_s.html#ga82fdb4e06174c84d7fe8c28f5d903dd4">add_radserver()</a>, <a class="el" href="group___l_i_b-_thread.html#ga810e4f7679b9091b76c1976ea1e56371">framework_mkthread()</a>, <a class="el" href="group___l_i_b-_i_n_i.html#ga7dbeb9280e11b1b65574494a2fc01160">process_config()</a>, <a class="el" href="group___l_i_b-_n_a_t6.html#ga6c761d18183be3df327a2a1d9bc0bfa9">rfc6296_map_add()</a>, and <a class="el" href="group___l_i_b-_x_s_l_t.html#ga734f1d4ec878a7ae1a50576ee91eef90">xslt_addparam()</a>.</p>
<div class="fragment"><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                                                              {</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="keywordtype">char</span> *ptr = <a class="code" href="structref__obj.html#a4725a0b14472b6571c3901ccc71bae08">data</a>;</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="keyword">struct </span><a class="code" href="structref__obj.html">ref_obj</a> *ref;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="keyword">struct </span><a class="code" href="structblist__obj.html">blist_obj</a> *lhead, *tmp;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="structblist__obj.html#a10e72984c2a9c6a3de07586c5d8a79c5">hash</a>, bucket;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="group___l_i_b-_o_b_j.html#ga3a67a6d45e39f530beb6e45b6b7e7d3b">objref</a>(blist)) {</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        <span class="keywordflow">return</span> (0);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    }</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="group___l_i_b-_o_b_j.html#ga3a67a6d45e39f530beb6e45b6b7e7d3b">objref</a>(<a class="code" href="structblist__obj.html#a6fa1ad5e6615e1e7fd15743800d9e78f">data</a>)) {</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;        <a class="code" href="group___l_i_b-_o_b_j.html#ga88a966a194cdf36fe9b5be0917ce86d9">objunref</a>(blist);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        <span class="keywordflow">return</span> (0);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    }</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    ptr = ptr - <a class="code" href="group___l_i_b-_o_b_j.html#ga0fbd2bea995f35a552a2a502e1119977">refobj_offset</a>;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    ref = (<span class="keyword">struct </span><a class="code" href="structref__obj.html">ref_obj</a> *)ptr;</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    hash = gethash(blist, <a class="code" href="structref__obj.html#a4725a0b14472b6571c3901ccc71bae08">data</a>, 0);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    bucket = ((hash &gt;&gt; (32 - blist-&gt;<a class="code" href="structbucket__list.html#a27d5a7bc37cf67aac5131f3ae21c1893">bucketbits</a>)) &amp; ((1 &lt;&lt; blist-&gt;<a class="code" href="structbucket__list.html#a27d5a7bc37cf67aac5131f3ae21c1893">bucketbits</a>) - 1));</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    pthread_mutex_lock(&amp;blist-&gt;<a class="code" href="structbucket__list.html#a55970b0d3a70126a24caee83bd6889d5">locks</a>[bucket]);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    lhead = blist-&gt;<a class="code" href="structbucket__list.html#a39f6f08d43f8c26616cac2a37ae2856c">list</a>[bucket];</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="comment">/*no head or non null head*/</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="keywordflow">if</span> (!lhead || lhead-&gt;<a class="code" href="structblist__obj.html#a61ae75a0a5d05916a302d365e7ca470a">prev</a>) {</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        <span class="keywordflow">if</span> (!(tmp = malloc(<span class="keyword">sizeof</span>(*tmp)))) {</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;            pthread_mutex_unlock(&amp;blist-&gt;<a class="code" href="structbucket__list.html#a55970b0d3a70126a24caee83bd6889d5">locks</a>[bucket]);</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            <a class="code" href="group___l_i_b-_o_b_j.html#ga88a966a194cdf36fe9b5be0917ce86d9">objunref</a>(<a class="code" href="structref__obj.html#a4725a0b14472b6571c3901ccc71bae08">data</a>);</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;            <a class="code" href="group___l_i_b-_o_b_j.html#ga88a966a194cdf36fe9b5be0917ce86d9">objunref</a>(blist);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;            <span class="keywordflow">return</span> (0);</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        }</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        memset(tmp, 0, <span class="keyword">sizeof</span>(*tmp));</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        tmp-&gt;<a class="code" href="structblist__obj.html#a10e72984c2a9c6a3de07586c5d8a79c5">hash</a> = hash;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        tmp-&gt;<a class="code" href="structblist__obj.html#a6fa1ad5e6615e1e7fd15743800d9e78f">data</a> = ref;</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        <span class="comment">/*there is no head*/</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        <span class="keywordflow">if</span> (!lhead) {</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;            blist-&gt;<a class="code" href="structbucket__list.html#a39f6f08d43f8c26616cac2a37ae2856c">list</a>[bucket] = tmp;</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;            tmp-&gt;<a class="code" href="structblist__obj.html#a61ae75a0a5d05916a302d365e7ca470a">prev</a> = tmp;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;            tmp-&gt;<a class="code" href="structblist__obj.html#aa2ccd4f4869b457fcca8ada6042bdb96">next</a> = NULL;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        <span class="comment">/*become new head*/</span></div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (hash &lt; lhead-&gt;hash) {</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;            tmp-&gt;<a class="code" href="structblist__obj.html#aa2ccd4f4869b457fcca8ada6042bdb96">next</a> = lhead;</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;            tmp-&gt;<a class="code" href="structblist__obj.html#a61ae75a0a5d05916a302d365e7ca470a">prev</a> = lhead-&gt;<a class="code" href="structblist__obj.html#a61ae75a0a5d05916a302d365e7ca470a">prev</a>;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            lhead-&gt;<a class="code" href="structblist__obj.html#a61ae75a0a5d05916a302d365e7ca470a">prev</a> = tmp;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;            blist-&gt;<a class="code" href="structbucket__list.html#a39f6f08d43f8c26616cac2a37ae2856c">list</a>[bucket] = tmp;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        <span class="comment">/*new tail*/</span></div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (hash &gt; lhead-&gt;<a class="code" href="structblist__obj.html#a61ae75a0a5d05916a302d365e7ca470a">prev</a>-&gt;<a class="code" href="structblist__obj.html#a10e72984c2a9c6a3de07586c5d8a79c5">hash</a>) {</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;            tmp-&gt;<a class="code" href="structblist__obj.html#a61ae75a0a5d05916a302d365e7ca470a">prev</a> = lhead-&gt;<a class="code" href="structblist__obj.html#a61ae75a0a5d05916a302d365e7ca470a">prev</a>;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;            tmp-&gt;<a class="code" href="structblist__obj.html#aa2ccd4f4869b457fcca8ada6042bdb96">next</a> = NULL;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;            lhead-&gt;<a class="code" href="structblist__obj.html#a61ae75a0a5d05916a302d365e7ca470a">prev</a>-&gt;<a class="code" href="structblist__obj.html#aa2ccd4f4869b457fcca8ada6042bdb96">next</a> = tmp;</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;            lhead-&gt;<a class="code" href="structblist__obj.html#a61ae75a0a5d05916a302d365e7ca470a">prev</a> = tmp;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        <span class="comment">/*insert entry*/</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;            lhead = blist_gotohash(lhead, hash, blist-&gt;<a class="code" href="structbucket__list.html#a27d5a7bc37cf67aac5131f3ae21c1893">bucketbits</a>);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;            tmp-&gt;<a class="code" href="structblist__obj.html#aa2ccd4f4869b457fcca8ada6042bdb96">next</a> = lhead-&gt;<a class="code" href="structblist__obj.html#aa2ccd4f4869b457fcca8ada6042bdb96">next</a>;</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;            tmp-&gt;<a class="code" href="structblist__obj.html#a61ae75a0a5d05916a302d365e7ca470a">prev</a> = lhead;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;            <span class="keywordflow">if</span> (lhead-&gt;<a class="code" href="structblist__obj.html#aa2ccd4f4869b457fcca8ada6042bdb96">next</a>) {</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                lhead-&gt;<a class="code" href="structblist__obj.html#aa2ccd4f4869b457fcca8ada6042bdb96">next</a>-&gt;<a class="code" href="structblist__obj.html#a61ae75a0a5d05916a302d365e7ca470a">prev</a> = tmp;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                blist-&gt;<a class="code" href="structbucket__list.html#a39f6f08d43f8c26616cac2a37ae2856c">list</a>[bucket]-&gt;<a class="code" href="structblist__obj.html#a61ae75a0a5d05916a302d365e7ca470a">prev</a> = tmp;</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;            }</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;            lhead-&gt;<a class="code" href="structblist__obj.html#aa2ccd4f4869b457fcca8ada6042bdb96">next</a> = tmp;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        }</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        <span class="comment">/*set NULL head*/</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        lhead-&gt;<a class="code" href="structblist__obj.html#a6fa1ad5e6615e1e7fd15743800d9e78f">data</a> = ref;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        lhead-&gt;<a class="code" href="structblist__obj.html#a61ae75a0a5d05916a302d365e7ca470a">prev</a> = lhead;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;        lhead-&gt;<a class="code" href="structblist__obj.html#aa2ccd4f4869b457fcca8ada6042bdb96">next</a> = NULL;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        lhead-&gt;<a class="code" href="structblist__obj.html#a10e72984c2a9c6a3de07586c5d8a79c5">hash</a> = hash;</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    }</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    blist-&gt;<a class="code" href="structbucket__list.html#a38a8dcfedb85da3556814085382f2bea">version</a>[bucket]++;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    pthread_mutex_unlock(&amp;blist-&gt;<a class="code" href="structbucket__list.html#a55970b0d3a70126a24caee83bd6889d5">locks</a>[bucket]);</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <a class="code" href="group___l_i_b-_o_b_j.html#ga4af4ae14c4a3e9f3037a09237bcfeae3">objlock</a>(blist);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    blist-&gt;<a class="code" href="structbucket__list.html#a59345370e4c9bbc627770d4b0b6aa30e">count</a>++;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <a class="code" href="group___l_i_b-_o_b_j.html#ga8c73b68730aa4452357e84af27e00008">objunlock</a>(blist);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <a class="code" href="group___l_i_b-_o_b_j.html#ga88a966a194cdf36fe9b5be0917ce86d9">objunref</a>(blist);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="keywordflow">return</span> (1);</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;}</div>
<div class="ttc" id="group___l_i_b-_o_b_j_html_ga0fbd2bea995f35a552a2a502e1119977"><div class="ttname"><a href="group___l_i_b-_o_b_j.html#ga0fbd2bea995f35a552a2a502e1119977">refobj_offset</a></div><div class="ttdeci">#define refobj_offset</div><div class="ttdoc">The size of ref_obj is the offset for the data. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00119">refobj.c:119</a></div></div>
<div class="ttc" id="structbucket__list_html_a39f6f08d43f8c26616cac2a37ae2856c"><div class="ttname"><a href="structbucket__list.html#a39f6f08d43f8c26616cac2a37ae2856c">bucket_list::list</a></div><div class="ttdeci">struct blist_obj ** list</div><div class="ttdoc">Array of blist_obj one per bucket ie 2^bucketbits. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00083">refobj.c:83</a></div></div>
<div class="ttc" id="group___l_i_b-_o_b_j_html_ga3a67a6d45e39f530beb6e45b6b7e7d3b"><div class="ttname"><a href="group___l_i_b-_o_b_j.html#ga3a67a6d45e39f530beb6e45b6b7e7d3b">objref</a></div><div class="ttdeci">int objref(void *data)</div><div class="ttdoc">Reference a object. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00153">refobj.c:153</a></div></div>
<div class="ttc" id="group___l_i_b-_o_b_j_html_ga4af4ae14c4a3e9f3037a09237bcfeae3"><div class="ttname"><a href="group___l_i_b-_o_b_j.html#ga4af4ae14c4a3e9f3037a09237bcfeae3">objlock</a></div><div class="ttdeci">int objlock(void *data)</div><div class="ttdoc">Lock the reference. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00269">refobj.c:269</a></div></div>
<div class="ttc" id="structblist__obj_html_a10e72984c2a9c6a3de07586c5d8a79c5"><div class="ttname"><a href="structblist__obj.html#a10e72984c2a9c6a3de07586c5d8a79c5">blist_obj::hash</a></div><div class="ttdeci">int32_t hash</div><div class="ttdoc">Hash value calculated from the data. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00064">refobj.c:64</a></div></div>
<div class="ttc" id="structblist__obj_html"><div class="ttname"><a href="structblist__obj.html">blist_obj</a></div><div class="ttdoc">Entry in a bucket list. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00061">refobj.c:61</a></div></div>
<div class="ttc" id="structbucket__list_html_a59345370e4c9bbc627770d4b0b6aa30e"><div class="ttname"><a href="structbucket__list.html#a59345370e4c9bbc627770d4b0b6aa30e">bucket_list::count</a></div><div class="ttdeci">size_t count</div><div class="ttdoc">Number of items held. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00079">refobj.c:79</a></div></div>
<div class="ttc" id="structbucket__list_html_a38a8dcfedb85da3556814085382f2bea"><div class="ttname"><a href="structbucket__list.html#a38a8dcfedb85da3556814085382f2bea">bucket_list::version</a></div><div class="ttdeci">size_t * version</div><div class="ttdoc">version of the bucket to detect changes during iteration (loop) </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00087">refobj.c:87</a></div></div>
<div class="ttc" id="structref__obj_html"><div class="ttname"><a href="structref__obj.html">ref_obj</a></div><div class="ttdoc">Internal structure of all referenced objects. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00038">refobj.c:38</a></div></div>
<div class="ttc" id="structblist__obj_html_a61ae75a0a5d05916a302d365e7ca470a"><div class="ttname"><a href="structblist__obj.html#a61ae75a0a5d05916a302d365e7ca470a">blist_obj::prev</a></div><div class="ttdeci">struct blist_obj * prev</div><div class="ttdoc">Previous entry in the bucket. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00068">refobj.c:68</a></div></div>
<div class="ttc" id="structref__obj_html_a4725a0b14472b6571c3901ccc71bae08"><div class="ttname"><a href="structref__obj.html#a4725a0b14472b6571c3901ccc71bae08">ref_obj::data</a></div><div class="ttdeci">void * data</div><div class="ttdoc">Pointer to the data referenced. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00054">refobj.c:54</a></div></div>
<div class="ttc" id="group___l_i_b-_o_b_j_html_ga8c73b68730aa4452357e84af27e00008"><div class="ttname"><a href="group___l_i_b-_o_b_j.html#ga8c73b68730aa4452357e84af27e00008">objunlock</a></div><div class="ttdeci">int objunlock(void *data)</div><div class="ttdoc">Unlock a reference. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00301">refobj.c:301</a></div></div>
<div class="ttc" id="structblist__obj_html_aa2ccd4f4869b457fcca8ada6042bdb96"><div class="ttname"><a href="structblist__obj.html#aa2ccd4f4869b457fcca8ada6042bdb96">blist_obj::next</a></div><div class="ttdeci">struct blist_obj * next</div><div class="ttdoc">Next entry in the bucket. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00066">refobj.c:66</a></div></div>
<div class="ttc" id="structbucket__list_html_a55970b0d3a70126a24caee83bd6889d5"><div class="ttname"><a href="structbucket__list.html#a55970b0d3a70126a24caee83bd6889d5">bucket_list::locks</a></div><div class="ttdeci">pthread_mutex_t * locks</div><div class="ttdoc">Array of locks one per bucket. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00085">refobj.c:85</a></div></div>
<div class="ttc" id="structbucket__list_html_a27d5a7bc37cf67aac5131f3ae21c1893"><div class="ttname"><a href="structbucket__list.html#a27d5a7bc37cf67aac5131f3ae21c1893">bucket_list::bucketbits</a></div><div class="ttdeci">unsigned short bucketbits</div><div class="ttdoc">number of buckets 2^n </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00077">refobj.c:77</a></div></div>
<div class="ttc" id="group___l_i_b-_o_b_j_html_ga88a966a194cdf36fe9b5be0917ce86d9"><div class="ttname"><a href="group___l_i_b-_o_b_j.html#ga88a966a194cdf36fe9b5be0917ce86d9">objunref</a></div><div class="ttdeci">int objunref(void *data)</div><div class="ttdoc">Drop reference held. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00184">refobj.c:184</a></div></div>
<div class="ttc" id="structblist__obj_html_a6fa1ad5e6615e1e7fd15743800d9e78f"><div class="ttname"><a href="structblist__obj.html#a6fa1ad5e6615e1e7fd15743800d9e78f">blist_obj::data</a></div><div class="ttdeci">struct ref_obj * data</div><div class="ttdoc">Reference to data held. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00070">refobj.c:70</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gaf312a26de37ad9594212c466a706c776"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int bucket_list_cnt </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structbucket__list.html">bucket_list</a> *&#160;</td>
          <td class="paramname"><em>blist</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return number of items in the list. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">blist</td><td>Bucket list to get count of. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Total number of items in all buckets. </dd></dl>

<p>Definition at line <a class="el" href="refobj_8c_source.html#l00552">552</a> of file <a class="el" href="refobj_8c_source.html">refobj.c</a>.</p>

<p>References <a class="el" href="structbucket__list.html#a59345370e4c9bbc627770d4b0b6aa30e">bucket_list::count</a>, <a class="el" href="group___l_i_b-_o_b_j.html#ga4af4ae14c4a3e9f3037a09237bcfeae3">objlock()</a>, and <a class="el" href="group___l_i_b-_o_b_j.html#ga8c73b68730aa4452357e84af27e00008">objunlock()</a>.</p>

<p>Referenced by <a class="el" href="group___l_i_b-_r_a_d_i_u_s.html#ga82fdb4e06174c84d7fe8c28f5d903dd4">add_radserver()</a>, <a class="el" href="group___l_i_b-_l_d_a_p.html#gafb3a53624d50c15f8660fd5e310bfe07">ldap_doadd()</a>, and <a class="el" href="group___l_i_b-_l_d_a_p.html#ga879a8a9934154de3e8ea1613ebc82ac1">ldap_domodify()</a>.</p>
<div class="fragment"><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                                                      {</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <span class="keywordtype">int</span> ret = -1;</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="keywordflow">if</span> (blist) {</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;        <a class="code" href="group___l_i_b-_o_b_j.html#ga4af4ae14c4a3e9f3037a09237bcfeae3">objlock</a>(blist);</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        ret = blist-&gt;<a class="code" href="structbucket__list.html#a59345370e4c9bbc627770d4b0b6aa30e">count</a>;</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;        <a class="code" href="group___l_i_b-_o_b_j.html#ga8c73b68730aa4452357e84af27e00008">objunlock</a>(blist);</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    }</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <span class="keywordflow">return</span> (ret);</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;}</div>
<div class="ttc" id="group___l_i_b-_o_b_j_html_ga4af4ae14c4a3e9f3037a09237bcfeae3"><div class="ttname"><a href="group___l_i_b-_o_b_j.html#ga4af4ae14c4a3e9f3037a09237bcfeae3">objlock</a></div><div class="ttdeci">int objlock(void *data)</div><div class="ttdoc">Lock the reference. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00269">refobj.c:269</a></div></div>
<div class="ttc" id="structbucket__list_html_a59345370e4c9bbc627770d4b0b6aa30e"><div class="ttname"><a href="structbucket__list.html#a59345370e4c9bbc627770d4b0b6aa30e">bucket_list::count</a></div><div class="ttdeci">size_t count</div><div class="ttdoc">Number of items held. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00079">refobj.c:79</a></div></div>
<div class="ttc" id="group___l_i_b-_o_b_j_html_ga8c73b68730aa4452357e84af27e00008"><div class="ttname"><a href="group___l_i_b-_o_b_j.html#ga8c73b68730aa4452357e84af27e00008">objunlock</a></div><div class="ttdeci">int objunlock(void *data)</div><div class="ttdoc">Unlock a reference. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00301">refobj.c:301</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gadcbb1534c836ba15aa2acf066bd5fff7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* bucket_list_find_key </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structbucket__list.html">bucket_list</a> *&#160;</td>
          <td class="paramname"><em>blist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find and return a reference to a item matching supplied key. </p>
<p>The key is supplied to the hash callback ad the data value and the key flag set. The hash for the object will be returned by the hash callback to find the item in the lists. </p>
<dl class="section note"><dt>Note</dt><dd>if the hash is not calculated equal to the original value it wont be found. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">blist</td><td>Bucket list to search. </td></tr>
    <tr><td class="paramname">key</td><td>Supplied to hash callback to find the item. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>New reference to the found item that needs to be unreferenced or NULL. </dd></dl>

<p>Definition at line <a class="el" href="refobj_8c_source.html#l00572">572</a> of file <a class="el" href="refobj_8c_source.html">refobj.c</a>.</p>

<p>References <a class="el" href="structbucket__list.html#a27d5a7bc37cf67aac5131f3ae21c1893">bucket_list::bucketbits</a>, <a class="el" href="structref__obj.html#a4725a0b14472b6571c3901ccc71bae08">ref_obj::data</a>, <a class="el" href="structblist__obj.html#a6fa1ad5e6615e1e7fd15743800d9e78f">blist_obj::data</a>, <a class="el" href="structblist__obj.html#a10e72984c2a9c6a3de07586c5d8a79c5">blist_obj::hash</a>, <a class="el" href="structbucket__list.html#a39f6f08d43f8c26616cac2a37ae2856c">bucket_list::list</a>, <a class="el" href="structbucket__list.html#a55970b0d3a70126a24caee83bd6889d5">bucket_list::locks</a>, <a class="el" href="group___l_i_b-_o_b_j.html#ga3a67a6d45e39f530beb6e45b6b7e7d3b">objref()</a>, and <a class="el" href="group___l_i_b-_o_b_j.html#ga88a966a194cdf36fe9b5be0917ce86d9">objunref()</a>.</p>

<p>Referenced by <a class="el" href="group___l_i_b-_i_n_i.html#ga86c44d5b975637cbf0a84e034a4c3d1e">get_config_category()</a>, <a class="el" href="group___l_i_b-_i_n_i.html#gaa0c111f840cf2b807ec54b42f7c9e89b">get_config_entry()</a>, <a class="el" href="group___l_i_b-_i_n_i.html#gaa3e89f20af266ba0c27f389645246390">get_config_file()</a>, <a class="el" href="group___l_i_b-_l_d_a_p.html#ga5d104d700aaff6de5e33167eb9510ea5">ldap_getattr()</a>, <a class="el" href="group___l_i_b-_l_d_a_p.html#ga153ea0b02a17531dfd8ed40b32126841">ldap_getentry()</a>, <a class="el" href="group___l_i_b-_n_f-_q.html#ga6a52ad68b657707bb0657a76e1db96ed">nfqueue_attach()</a>, <a class="el" href="group___l_i_b-_x_m_l.html#ga63131b697dd2e587e1ce57a0bdefc23c">xml_getattr()</a>, and <a class="el" href="group___l_i_b-_x_m_l.html#ga6556cc28dbd3724698be265d1127eaf6">xml_getnode()</a>.</p>
<div class="fragment"><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                                                                              {</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="keyword">struct </span><a class="code" href="structblist__obj.html">blist_obj</a> *entry;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structblist__obj.html#a10e72984c2a9c6a3de07586c5d8a79c5">hash</a>, bucket;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <span class="keywordflow">if</span> (!blist) {</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        <span class="keywordflow">return</span> (NULL);</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    }</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    hash = gethash(blist, key, 1);</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    bucket = ((hash &gt;&gt; (32 - blist-&gt;<a class="code" href="structbucket__list.html#a27d5a7bc37cf67aac5131f3ae21c1893">bucketbits</a>)) &amp; ((1 &lt;&lt; blist-&gt;<a class="code" href="structbucket__list.html#a27d5a7bc37cf67aac5131f3ae21c1893">bucketbits</a>) - 1));</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    pthread_mutex_lock(&amp;blist-&gt;<a class="code" href="structbucket__list.html#a55970b0d3a70126a24caee83bd6889d5">locks</a>[bucket]);</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    entry = blist_gotohash(blist-&gt;<a class="code" href="structbucket__list.html#a39f6f08d43f8c26616cac2a37ae2856c">list</a>[bucket], hash + 1, blist-&gt;<a class="code" href="structbucket__list.html#a27d5a7bc37cf67aac5131f3ae21c1893">bucketbits</a>);</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="keywordflow">if</span> (entry &amp;&amp; entry-&gt;<a class="code" href="structblist__obj.html#a6fa1ad5e6615e1e7fd15743800d9e78f">data</a>) {</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        <a class="code" href="group___l_i_b-_o_b_j.html#ga3a67a6d45e39f530beb6e45b6b7e7d3b">objref</a>(entry-&gt;<a class="code" href="structblist__obj.html#a6fa1ad5e6615e1e7fd15743800d9e78f">data</a>-&gt;<a class="code" href="structref__obj.html#a4725a0b14472b6571c3901ccc71bae08">data</a>);</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    } <span class="keywordflow">else</span></div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        <span class="keywordflow">if</span> (!entry) {</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;            pthread_mutex_unlock(&amp;blist-&gt;<a class="code" href="structbucket__list.html#a55970b0d3a70126a24caee83bd6889d5">locks</a>[bucket]);</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;            <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;        }</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    pthread_mutex_unlock(&amp;blist-&gt;<a class="code" href="structbucket__list.html#a55970b0d3a70126a24caee83bd6889d5">locks</a>[bucket]);</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <span class="keywordflow">if</span> (entry-&gt;<a class="code" href="structblist__obj.html#a6fa1ad5e6615e1e7fd15743800d9e78f">data</a> &amp;&amp; (entry-&gt;<a class="code" href="structblist__obj.html#a10e72984c2a9c6a3de07586c5d8a79c5">hash</a> == hash)) {</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        <span class="keywordflow">return</span> (entry-&gt;<a class="code" href="structblist__obj.html#a6fa1ad5e6615e1e7fd15743800d9e78f">data</a>-&gt;<a class="code" href="structref__obj.html#a4725a0b14472b6571c3901ccc71bae08">data</a>);</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    } <span class="keywordflow">else</span></div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        <span class="keywordflow">if</span> (entry-&gt;<a class="code" href="structblist__obj.html#a6fa1ad5e6615e1e7fd15743800d9e78f">data</a>) {</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;            <a class="code" href="group___l_i_b-_o_b_j.html#ga88a966a194cdf36fe9b5be0917ce86d9">objunref</a>(entry-&gt;<a class="code" href="structblist__obj.html#a6fa1ad5e6615e1e7fd15743800d9e78f">data</a>-&gt;<a class="code" href="structref__obj.html#a4725a0b14472b6571c3901ccc71bae08">data</a>);</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        }</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;}</div>
<div class="ttc" id="structbucket__list_html_a39f6f08d43f8c26616cac2a37ae2856c"><div class="ttname"><a href="structbucket__list.html#a39f6f08d43f8c26616cac2a37ae2856c">bucket_list::list</a></div><div class="ttdeci">struct blist_obj ** list</div><div class="ttdoc">Array of blist_obj one per bucket ie 2^bucketbits. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00083">refobj.c:83</a></div></div>
<div class="ttc" id="group___l_i_b-_o_b_j_html_ga3a67a6d45e39f530beb6e45b6b7e7d3b"><div class="ttname"><a href="group___l_i_b-_o_b_j.html#ga3a67a6d45e39f530beb6e45b6b7e7d3b">objref</a></div><div class="ttdeci">int objref(void *data)</div><div class="ttdoc">Reference a object. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00153">refobj.c:153</a></div></div>
<div class="ttc" id="structblist__obj_html_a10e72984c2a9c6a3de07586c5d8a79c5"><div class="ttname"><a href="structblist__obj.html#a10e72984c2a9c6a3de07586c5d8a79c5">blist_obj::hash</a></div><div class="ttdeci">int32_t hash</div><div class="ttdoc">Hash value calculated from the data. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00064">refobj.c:64</a></div></div>
<div class="ttc" id="structblist__obj_html"><div class="ttname"><a href="structblist__obj.html">blist_obj</a></div><div class="ttdoc">Entry in a bucket list. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00061">refobj.c:61</a></div></div>
<div class="ttc" id="structref__obj_html_a4725a0b14472b6571c3901ccc71bae08"><div class="ttname"><a href="structref__obj.html#a4725a0b14472b6571c3901ccc71bae08">ref_obj::data</a></div><div class="ttdeci">void * data</div><div class="ttdoc">Pointer to the data referenced. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00054">refobj.c:54</a></div></div>
<div class="ttc" id="structbucket__list_html_a55970b0d3a70126a24caee83bd6889d5"><div class="ttname"><a href="structbucket__list.html#a55970b0d3a70126a24caee83bd6889d5">bucket_list::locks</a></div><div class="ttdeci">pthread_mutex_t * locks</div><div class="ttdoc">Array of locks one per bucket. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00085">refobj.c:85</a></div></div>
<div class="ttc" id="structbucket__list_html_a27d5a7bc37cf67aac5131f3ae21c1893"><div class="ttname"><a href="structbucket__list.html#a27d5a7bc37cf67aac5131f3ae21c1893">bucket_list::bucketbits</a></div><div class="ttdeci">unsigned short bucketbits</div><div class="ttdoc">number of buckets 2^n </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00077">refobj.c:77</a></div></div>
<div class="ttc" id="group___l_i_b-_o_b_j_html_ga88a966a194cdf36fe9b5be0917ce86d9"><div class="ttname"><a href="group___l_i_b-_o_b_j.html#ga88a966a194cdf36fe9b5be0917ce86d9">objunref</a></div><div class="ttdeci">int objunref(void *data)</div><div class="ttdoc">Drop reference held. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00184">refobj.c:184</a></div></div>
<div class="ttc" id="structblist__obj_html_a6fa1ad5e6615e1e7fd15743800d9e78f"><div class="ttname"><a href="structblist__obj.html#a6fa1ad5e6615e1e7fd15743800d9e78f">blist_obj::data</a></div><div class="ttdeci">struct ref_obj * data</div><div class="ttdoc">Reference to data held. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00070">refobj.c:70</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga55c344ef8eb37a0a76eac1de01d36349"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void bucketlist_callback </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structbucket__list.html">bucket_list</a> *&#160;</td>
          <td class="paramname"><em>blist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group___l_i_b-_o_b_j-_bucket.html#ga35996929b1a3aae886be2e45d1cadfec">blist_cb</a>&#160;</td>
          <td class="paramname"><em>callback</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Run a callback function on all items in the list. </p>
<p>This will iterate safely through all items calling the callback with the item and the optional data supplied. </p>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group___l_i_b-_o_b_j-_bucket.html#ga35996929b1a3aae886be2e45d1cadfec" title="This callback is run on each entry in a list. ">blist_cb</a> </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">blist</td><td>Bucket list to iterate through. </td></tr>
    <tr><td class="paramname">callback</td><td>Callback to call for each iteration. </td></tr>
    <tr><td class="paramname">data2</td><td>Data to be set as option to the callback. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="refobj_8c_source.html#l00613">613</a> of file <a class="el" href="refobj_8c_source.html">refobj.c</a>.</p>

<p>References <a class="el" href="group___l_i_b-_o_b_j-_bucket.html#gaf05994d11e28a40271f80db3f3668852">init_bucket_loop()</a>, <a class="el" href="group___l_i_b-_o_b_j-_bucket.html#ga4dfa18d64062aae420d9d7ab1c9943d7">next_bucket_loop()</a>, and <a class="el" href="group___l_i_b-_o_b_j.html#ga88a966a194cdf36fe9b5be0917ce86d9">objunref()</a>.</p>

<p>Referenced by <a class="el" href="group___l_i_b-_i_n_i.html#ga05d72d8b45f4c0838f417923a0ce8f06">config_cat_callback()</a>, <a class="el" href="group___l_i_b-_i_n_i.html#gadc8b44af6ff37b8f84d8ce70a3c0f85b">config_entry_callback()</a>, <a class="el" href="group___l_i_b-_i_n_i.html#ga2d71de953de42dd2d90d20a3a5467c47">config_file_callback()</a>, and <a class="el" href="group___l_i_b-_n_a_t6.html#ga05d6c7b8c8759920bf5103742987f7a6">rfc6296_test()</a>.</p>
<div class="fragment"><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                                                                                           {</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    <span class="keyword">struct </span><a class="code" href="structbucket__loop.html">bucket_loop</a> *bloop;</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <span class="keywordtype">void</span> *data;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <span class="keywordflow">if</span> (!blist || !callback) {</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    }</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    bloop = <a class="code" href="group___l_i_b-_o_b_j-_bucket.html#gaf05994d11e28a40271f80db3f3668852">init_bucket_loop</a>(blist);</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="keywordflow">while</span>(blist &amp;&amp; bloop &amp;&amp; (data = <a class="code" href="group___l_i_b-_o_b_j-_bucket.html#ga4dfa18d64062aae420d9d7ab1c9943d7">next_bucket_loop</a>(bloop))) {</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        callback(data, data2);</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        <a class="code" href="group___l_i_b-_o_b_j.html#ga88a966a194cdf36fe9b5be0917ce86d9">objunref</a>(data);</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    }</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <a class="code" href="group___l_i_b-_o_b_j.html#ga88a966a194cdf36fe9b5be0917ce86d9">objunref</a>(bloop);</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;}</div>
<div class="ttc" id="structbucket__loop_html"><div class="ttname"><a href="structbucket__loop.html">bucket_loop</a></div><div class="ttdoc">Bucket iterator. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00097">refobj.c:97</a></div></div>
<div class="ttc" id="group___l_i_b-_o_b_j-_bucket_html_ga4dfa18d64062aae420d9d7ab1c9943d7"><div class="ttname"><a href="group___l_i_b-_o_b_j-_bucket.html#ga4dfa18d64062aae420d9d7ab1c9943d7">next_bucket_loop</a></div><div class="ttdeci">void * next_bucket_loop(struct bucket_loop *bloop)</div><div class="ttdoc">Return a reference to the next item in the list this could be the first item. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00662">refobj.c:662</a></div></div>
<div class="ttc" id="group___l_i_b-_o_b_j_html_ga88a966a194cdf36fe9b5be0917ce86d9"><div class="ttname"><a href="group___l_i_b-_o_b_j.html#ga88a966a194cdf36fe9b5be0917ce86d9">objunref</a></div><div class="ttdeci">int objunref(void *data)</div><div class="ttdoc">Drop reference held. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00184">refobj.c:184</a></div></div>
<div class="ttc" id="group___l_i_b-_o_b_j-_bucket_html_gaf05994d11e28a40271f80db3f3668852"><div class="ttname"><a href="group___l_i_b-_o_b_j-_bucket.html#gaf05994d11e28a40271f80db3f3668852">init_bucket_loop</a></div><div class="ttdeci">struct bucket_loop * init_bucket_loop(struct bucket_list *blist)</div><div class="ttdoc">Create a bucket list iterator to safely iterate the list. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00640">refobj.c:640</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga504545b538666017fe0d41e428310341"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* create_bucketlist </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>bitmask</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group___l_i_b-_o_b_j-_bucket.html#gabf1358cda7e434b44a959039e6fabfce">blisthash</a>&#160;</td>
          <td class="paramname"><em>hash_function</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="refobj_8c_source.html#l00356">356</a> of file <a class="el" href="refobj_8c_source.html">refobj.c</a>.</p>

<p>References <a class="el" href="structbucket__list.html#a27d5a7bc37cf67aac5131f3ae21c1893">bucket_list::bucketbits</a>, and <a class="el" href="group___l_i_b-_o_b_j.html#ga21cf8972a38aed3f153f4ed06b12a419">objalloc()</a>.</p>

<p>Referenced by <a class="el" href="group___l_i_b-_r_a_d_i_u_s.html#ga82fdb4e06174c84d7fe8c28f5d903dd4">add_radserver()</a>, <a class="el" href="group___l_i_b-_l_d_a_p.html#gafce6d8814b3bdf793cabb6fcc2f79833">ldap_addinit()</a>, <a class="el" href="group___l_i_b-_l_d_a_p.html#ga9abb041462703514fe1ed59a071bf688">ldap_modifyinit()</a>, <a class="el" href="group___l_i_b-_n_a_t6.html#ga6c761d18183be3df327a2a1d9bc0bfa9">rfc6296_map_add()</a>, <a class="el" href="group___l_i_b-_sock.html#ga4c08ae54e4e2d9ae7fa2f3a3a17a2e81">socketserver()</a>, <a class="el" href="group___l_i_b-_thread.html#ga5196903ef5e3e656b28c52e045f7c3f3">startthreads()</a>, <a class="el" href="group___l_i_b-_x_s_l_t.html#ga8fb842b8c9126530b5f1da64c388c443">xslt_clearparam()</a>, and <a class="el" href="group___l_i_b-_x_s_l_t.html#gae4e57cd34418965c1fb559cee95c4496">xslt_open()</a>.</p>
<div class="fragment"><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                                                                     {</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="keyword">struct </span><a class="code" href="structbucket__list.html">bucket_list</a> *<span class="keyword">new</span>;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="keywordtype">short</span> <span class="keywordtype">int</span> buckets, cnt;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    buckets = (1 &lt;&lt; bitmask);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="comment">/* allocate session bucket list memory size of the struct plus a list lock and version for each bucket*/</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    <span class="keywordflow">if</span> (!(<span class="keyword">new</span> = <a class="code" href="group___l_i_b-_o_b_j.html#ga21cf8972a38aed3f153f4ed06b12a419">objalloc</a>(<span class="keyword">sizeof</span>(*<span class="keyword">new</span>) + (<span class="keyword">sizeof</span>(<span class="keywordtype">void</span> *) + <span class="keyword">sizeof</span>(pthread_mutex_t) + <span class="keyword">sizeof</span>(<span class="keywordtype">size_t</span>)) * buckets, empty_buckets))) {</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    }</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="comment">/*initialise each bucket*/</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keyword">new</span>-&gt;<a class="code" href="structbucket__list.html#a27d5a7bc37cf67aac5131f3ae21c1893">bucketbits</a> = bitmask;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    <span class="keyword">new</span>-&gt;list = (<span class="keywordtype">void</span> *)((<span class="keywordtype">char</span> *)<span class="keyword">new</span> + <span class="keyword">sizeof</span>(*new));</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="keywordflow">for</span> (cnt = 0; cnt &lt; buckets; cnt++) {</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        <span class="keywordflow">if</span> ((new-&gt;list[cnt] = malloc(<span class="keyword">sizeof</span>(*new-&gt;list[cnt])))) {</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;            memset(new-&gt;list[cnt], 0, <span class="keyword">sizeof</span>(*new-&gt;list[cnt]));</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        }</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    }</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="comment">/*next pointer is pointer to locks*/</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="keyword">new</span>-&gt;locks = (<span class="keywordtype">void</span> *)&amp;new-&gt;list[buckets];</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    for (cnt = 0; cnt &lt; buckets; cnt++) {</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        pthread_mutex_init(&amp;new-&gt;locks[cnt], NULL);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    }</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;    <span class="comment">/*Next up version array*/</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keyword">new</span>-&gt;version = (<span class="keywordtype">void</span> *)&amp;new-&gt;locks[buckets];</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;    new-&gt;hash_func = hash_function;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    return (<span class="keyword">new</span>);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;}</div>
<div class="ttc" id="group___l_i_b-_o_b_j_html_ga21cf8972a38aed3f153f4ed06b12a419"><div class="ttname"><a href="group___l_i_b-_o_b_j.html#ga21cf8972a38aed3f153f4ed06b12a419">objalloc</a></div><div class="ttdeci">void * objalloc(int size, objdestroy)</div><div class="ttdoc">Allocate a referenced lockable object. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00129">refobj.c:129</a></div></div>
<div class="ttc" id="structbucket__list_html_a27d5a7bc37cf67aac5131f3ae21c1893"><div class="ttname"><a href="structbucket__list.html#a27d5a7bc37cf67aac5131f3ae21c1893">bucket_list::bucketbits</a></div><div class="ttdeci">unsigned short bucketbits</div><div class="ttdoc">number of buckets 2^n </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00077">refobj.c:77</a></div></div>
<div class="ttc" id="structbucket__list_html"><div class="ttname"><a href="structbucket__list.html">bucket_list</a></div><div class="ttdoc">Bucket list, hold hashed objects in buckets. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00075">refobj.c:75</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gaf05994d11e28a40271f80db3f3668852"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structbucket__loop.html">bucket_loop</a>* init_bucket_loop </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structbucket__list.html">bucket_list</a> *&#160;</td>
          <td class="paramname"><em>blist</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a bucket list iterator to safely iterate the list. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">blist</td><td>Bucket list to create iterator for. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Bucket list iterator that needs to be unreferenced when completed. </dd></dl>

<p>Definition at line <a class="el" href="refobj_8c_source.html#l00640">640</a> of file <a class="el" href="refobj_8c_source.html">refobj.c</a>.</p>

<p>References <a class="el" href="structbucket__loop.html#aa56b1e578b1d53f1a9c3a4b9abb694e3">bucket_loop::blist</a>, <a class="el" href="structbucket__loop.html#a5786da1ec8486c4293e2abf4fc554b40">bucket_loop::bucket</a>, <a class="el" href="structblist__obj.html#a10e72984c2a9c6a3de07586c5d8a79c5">blist_obj::hash</a>, <a class="el" href="structbucket__loop.html#a91dd157ebd0336f01305dba937d13b76">bucket_loop::head</a>, <a class="el" href="structbucket__loop.html#a4e6ef15df0a3abd280bf6f04d4c2b95a">bucket_loop::head_hash</a>, <a class="el" href="structbucket__list.html#a39f6f08d43f8c26616cac2a37ae2856c">bucket_list::list</a>, <a class="el" href="structbucket__list.html#a55970b0d3a70126a24caee83bd6889d5">bucket_list::locks</a>, <a class="el" href="group___l_i_b-_o_b_j.html#ga21cf8972a38aed3f153f4ed06b12a419">objalloc()</a>, <a class="el" href="group___l_i_b-_o_b_j.html#ga3a67a6d45e39f530beb6e45b6b7e7d3b">objref()</a>, <a class="el" href="structbucket__list.html#a38a8dcfedb85da3556814085382f2bea">bucket_list::version</a>, and <a class="el" href="structbucket__loop.html#a490142bbc1e0b029834e8e2e5b548ecb">bucket_loop::version</a>.</p>

<p>Referenced by <a class="el" href="group___l_i_b-_o_b_j-_bucket.html#ga55c344ef8eb37a0a76eac1de01d36349">bucketlist_callback()</a>, <a class="el" href="group___l_i_b-_i_n_i.html#ga9f9a4e6930756767fd89ceda044e0c3d">get_category_loop()</a>, <a class="el" href="group___l_i_b-_l_d_a_p.html#gafb3a53624d50c15f8660fd5e310bfe07">ldap_doadd()</a>, and <a class="el" href="group___l_i_b-_l_d_a_p.html#ga879a8a9934154de3e8ea1613ebc82ac1">ldap_domodify()</a>.</p>
<div class="fragment"><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                                                                       {</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <span class="keyword">struct </span><a class="code" href="structbucket__loop.html">bucket_loop</a> *bloop = NULL;</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <span class="keywordflow">if</span> (blist &amp;&amp; (bloop = <a class="code" href="group___l_i_b-_o_b_j.html#ga21cf8972a38aed3f153f4ed06b12a419">objalloc</a>(<span class="keyword">sizeof</span>(*bloop), free_bloop))) {</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;        <a class="code" href="group___l_i_b-_o_b_j.html#ga3a67a6d45e39f530beb6e45b6b7e7d3b">objref</a>(blist);</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        bloop-&gt;<a class="code" href="structbucket__loop.html#aa56b1e578b1d53f1a9c3a4b9abb694e3">blist</a> = <a class="code" href="structbucket__loop.html#aa56b1e578b1d53f1a9c3a4b9abb694e3">blist</a>;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        bloop-&gt;<a class="code" href="structbucket__loop.html#a5786da1ec8486c4293e2abf4fc554b40">bucket</a> = 0;</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;        pthread_mutex_lock(&amp;blist-&gt;<a class="code" href="structbucket__list.html#a55970b0d3a70126a24caee83bd6889d5">locks</a>[bloop-&gt;<a class="code" href="structbucket__loop.html#a5786da1ec8486c4293e2abf4fc554b40">bucket</a>]);</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        bloop-&gt;<a class="code" href="structbucket__loop.html#a91dd157ebd0336f01305dba937d13b76">head</a> = blist-&gt;<a class="code" href="structbucket__list.html#a39f6f08d43f8c26616cac2a37ae2856c">list</a>[0];</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;        <span class="keywordflow">if</span> (bloop-&gt;<a class="code" href="structbucket__loop.html#a91dd157ebd0336f01305dba937d13b76">head</a>) {</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;            bloop-&gt;<a class="code" href="structbucket__loop.html#a4e6ef15df0a3abd280bf6f04d4c2b95a">head_hash</a> = bloop-&gt;<a class="code" href="structbucket__loop.html#a91dd157ebd0336f01305dba937d13b76">head</a>-&gt;<a class="code" href="structblist__obj.html#a10e72984c2a9c6a3de07586c5d8a79c5">hash</a>;</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        };</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;        bloop-&gt;<a class="code" href="structbucket__loop.html#a490142bbc1e0b029834e8e2e5b548ecb">version</a> = blist-&gt;<a class="code" href="structbucket__list.html#a38a8dcfedb85da3556814085382f2bea">version</a>[0];</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        pthread_mutex_unlock(&amp;blist-&gt;<a class="code" href="structbucket__list.html#a55970b0d3a70126a24caee83bd6889d5">locks</a>[bloop-&gt;<a class="code" href="structbucket__loop.html#a5786da1ec8486c4293e2abf4fc554b40">bucket</a>]);</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    }</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <span class="keywordflow">return</span> (bloop);</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;}</div>
<div class="ttc" id="structbucket__loop_html"><div class="ttname"><a href="structbucket__loop.html">bucket_loop</a></div><div class="ttdoc">Bucket iterator. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00097">refobj.c:97</a></div></div>
<div class="ttc" id="structbucket__list_html_a39f6f08d43f8c26616cac2a37ae2856c"><div class="ttname"><a href="structbucket__list.html#a39f6f08d43f8c26616cac2a37ae2856c">bucket_list::list</a></div><div class="ttdeci">struct blist_obj ** list</div><div class="ttdoc">Array of blist_obj one per bucket ie 2^bucketbits. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00083">refobj.c:83</a></div></div>
<div class="ttc" id="group___l_i_b-_o_b_j_html_ga3a67a6d45e39f530beb6e45b6b7e7d3b"><div class="ttname"><a href="group___l_i_b-_o_b_j.html#ga3a67a6d45e39f530beb6e45b6b7e7d3b">objref</a></div><div class="ttdeci">int objref(void *data)</div><div class="ttdoc">Reference a object. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00153">refobj.c:153</a></div></div>
<div class="ttc" id="structbucket__loop_html_a4e6ef15df0a3abd280bf6f04d4c2b95a"><div class="ttname"><a href="structbucket__loop.html#a4e6ef15df0a3abd280bf6f04d4c2b95a">bucket_loop::head_hash</a></div><div class="ttdeci">uint32_t head_hash</div><div class="ttdoc">Hash of head if we need to comeback. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00106">refobj.c:106</a></div></div>
<div class="ttc" id="structbucket__loop_html_a5786da1ec8486c4293e2abf4fc554b40"><div class="ttname"><a href="structbucket__loop.html#a5786da1ec8486c4293e2abf4fc554b40">bucket_loop::bucket</a></div><div class="ttdeci">unsigned short bucket</div><div class="ttdoc">Active bucket as determined by hash. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00101">refobj.c:101</a></div></div>
<div class="ttc" id="structblist__obj_html_a10e72984c2a9c6a3de07586c5d8a79c5"><div class="ttname"><a href="structblist__obj.html#a10e72984c2a9c6a3de07586c5d8a79c5">blist_obj::hash</a></div><div class="ttdeci">int32_t hash</div><div class="ttdoc">Hash value calculated from the data. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00064">refobj.c:64</a></div></div>
<div class="ttc" id="group___l_i_b-_o_b_j_html_ga21cf8972a38aed3f153f4ed06b12a419"><div class="ttname"><a href="group___l_i_b-_o_b_j.html#ga21cf8972a38aed3f153f4ed06b12a419">objalloc</a></div><div class="ttdeci">void * objalloc(int size, objdestroy)</div><div class="ttdoc">Allocate a referenced lockable object. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00129">refobj.c:129</a></div></div>
<div class="ttc" id="structbucket__loop_html_a91dd157ebd0336f01305dba937d13b76"><div class="ttname"><a href="structbucket__loop.html#a91dd157ebd0336f01305dba937d13b76">bucket_loop::head</a></div><div class="ttdeci">struct blist_obj * head</div><div class="ttdoc">Current bucket. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00110">refobj.c:110</a></div></div>
<div class="ttc" id="structbucket__list_html_a38a8dcfedb85da3556814085382f2bea"><div class="ttname"><a href="structbucket__list.html#a38a8dcfedb85da3556814085382f2bea">bucket_list::version</a></div><div class="ttdeci">size_t * version</div><div class="ttdoc">version of the bucket to detect changes during iteration (loop) </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00087">refobj.c:87</a></div></div>
<div class="ttc" id="structbucket__loop_html_a490142bbc1e0b029834e8e2e5b548ecb"><div class="ttname"><a href="structbucket__loop.html#a490142bbc1e0b029834e8e2e5b548ecb">bucket_loop::version</a></div><div class="ttdeci">size_t version</div><div class="ttdoc">Our version check this with blist to determine if we must rewined and fast forward. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00104">refobj.c:104</a></div></div>
<div class="ttc" id="structbucket__loop_html_aa56b1e578b1d53f1a9c3a4b9abb694e3"><div class="ttname"><a href="structbucket__loop.html#aa56b1e578b1d53f1a9c3a4b9abb694e3">bucket_loop::blist</a></div><div class="ttdeci">struct bucket_list * blist</div><div class="ttdoc">Referenece to the bucket been itereated. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00099">refobj.c:99</a></div></div>
<div class="ttc" id="structbucket__list_html_a55970b0d3a70126a24caee83bd6889d5"><div class="ttname"><a href="structbucket__list.html#a55970b0d3a70126a24caee83bd6889d5">bucket_list::locks</a></div><div class="ttdeci">pthread_mutex_t * locks</div><div class="ttdoc">Array of locks one per bucket. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00085">refobj.c:85</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga4dfa18d64062aae420d9d7ab1c9943d7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* next_bucket_loop </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structbucket__loop.html">bucket_loop</a> *&#160;</td>
          <td class="paramname"><em>bloop</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Return a reference to the next item in the list this could be the first item. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">bloop</td><td>Bucket iterator </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Next available item or NULL when there no items left </dd></dl>

<p>Definition at line <a class="el" href="refobj_8c_source.html#l00662">662</a> of file <a class="el" href="refobj_8c_source.html">refobj.c</a>.</p>

<p>References <a class="el" href="structbucket__loop.html#aa56b1e578b1d53f1a9c3a4b9abb694e3">bucket_loop::blist</a>, <a class="el" href="structbucket__loop.html#a5786da1ec8486c4293e2abf4fc554b40">bucket_loop::bucket</a>, <a class="el" href="structbucket__list.html#a27d5a7bc37cf67aac5131f3ae21c1893">bucket_list::bucketbits</a>, <a class="el" href="structbucket__loop.html#a25c4c5aefd932a39f8d444ef7cdd1fa1">bucket_loop::cur</a>, <a class="el" href="structbucket__loop.html#a20c18d1924487b7918f2d9cee958ebc5">bucket_loop::cur_hash</a>, <a class="el" href="structref__obj.html#a4725a0b14472b6571c3901ccc71bae08">ref_obj::data</a>, <a class="el" href="structblist__obj.html#a6fa1ad5e6615e1e7fd15743800d9e78f">blist_obj::data</a>, <a class="el" href="structblist__obj.html#a10e72984c2a9c6a3de07586c5d8a79c5">blist_obj::hash</a>, <a class="el" href="structbucket__loop.html#a91dd157ebd0336f01305dba937d13b76">bucket_loop::head</a>, <a class="el" href="structbucket__loop.html#a4e6ef15df0a3abd280bf6f04d4c2b95a">bucket_loop::head_hash</a>, <a class="el" href="structbucket__list.html#a39f6f08d43f8c26616cac2a37ae2856c">bucket_list::list</a>, <a class="el" href="structbucket__list.html#a55970b0d3a70126a24caee83bd6889d5">bucket_list::locks</a>, <a class="el" href="structblist__obj.html#aa2ccd4f4869b457fcca8ada6042bdb96">blist_obj::next</a>, <a class="el" href="group___l_i_b-_o_b_j.html#ga3a67a6d45e39f530beb6e45b6b7e7d3b">objref()</a>, <a class="el" href="structblist__obj.html#a61ae75a0a5d05916a302d365e7ca470a">blist_obj::prev</a>, <a class="el" href="structbucket__list.html#a38a8dcfedb85da3556814085382f2bea">bucket_list::version</a>, and <a class="el" href="structbucket__loop.html#a490142bbc1e0b029834e8e2e5b548ecb">bucket_loop::version</a>.</p>

<p>Referenced by <a class="el" href="group___l_i_b-_o_b_j-_bucket.html#ga55c344ef8eb37a0a76eac1de01d36349">bucketlist_callback()</a>, <a class="el" href="group___l_i_b-_i_n_i.html#gacda25f5961b62c5de343589c3a72b771">get_category_next()</a>, <a class="el" href="group___l_i_b-_l_d_a_p.html#gafb3a53624d50c15f8660fd5e310bfe07">ldap_doadd()</a>, and <a class="el" href="group___l_i_b-_l_d_a_p.html#ga879a8a9934154de3e8ea1613ebc82ac1">ldap_domodify()</a>.</p>
<div class="fragment"><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;                                                         {</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <span class="keyword">struct </span><a class="code" href="structbucket__list.html">bucket_list</a> *blist = bloop-&gt;<a class="code" href="structbucket__loop.html#aa56b1e578b1d53f1a9c3a4b9abb694e3">blist</a>;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <span class="keyword">struct </span><a class="code" href="structref__obj.html">ref_obj</a> *entry = NULL;</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <span class="keywordtype">void</span> *<a class="code" href="structref__obj.html#a4725a0b14472b6571c3901ccc71bae08">data</a> = NULL;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    pthread_mutex_lock(&amp;blist-&gt;<a class="code" href="structbucket__list.html#a55970b0d3a70126a24caee83bd6889d5">locks</a>[bloop-&gt;<a class="code" href="structbucket__loop.html#a5786da1ec8486c4293e2abf4fc554b40">bucket</a>]);</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <span class="keywordflow">if</span> (bloop-&gt;<a class="code" href="structbucket__loop.html#a4e6ef15df0a3abd280bf6f04d4c2b95a">head_hash</a> &amp;&amp; (blist-&gt;<a class="code" href="structbucket__list.html#a38a8dcfedb85da3556814085382f2bea">version</a>[bloop-&gt;<a class="code" href="structbucket__loop.html#a5786da1ec8486c4293e2abf4fc554b40">bucket</a>] != bloop-&gt;<a class="code" href="structbucket__loop.html#a490142bbc1e0b029834e8e2e5b548ecb">version</a>)) {</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        <span class="comment">/* bucket has changed unexpectedly i need to ff/rew to hash*/</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        bloop-&gt;<a class="code" href="structbucket__loop.html#a91dd157ebd0336f01305dba937d13b76">head</a> = blist_gotohash(blist-&gt;<a class="code" href="structbucket__list.html#a39f6f08d43f8c26616cac2a37ae2856c">list</a>[bloop-&gt;<a class="code" href="structbucket__loop.html#a5786da1ec8486c4293e2abf4fc554b40">bucket</a>], bloop-&gt;<a class="code" href="structbucket__loop.html#a4e6ef15df0a3abd280bf6f04d4c2b95a">head_hash</a> + 1, blist-&gt;<a class="code" href="structbucket__list.html#a27d5a7bc37cf67aac5131f3ae21c1893">bucketbits</a>);</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        <span class="comment">/*if head has gone find next suitable ignore any added*/</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        <span class="keywordflow">while</span> (bloop-&gt;<a class="code" href="structbucket__loop.html#a91dd157ebd0336f01305dba937d13b76">head</a> &amp;&amp; (bloop-&gt;<a class="code" href="structbucket__loop.html#a91dd157ebd0336f01305dba937d13b76">head</a>-&gt;<a class="code" href="structblist__obj.html#a10e72984c2a9c6a3de07586c5d8a79c5">hash</a> &lt; bloop-&gt;<a class="code" href="structbucket__loop.html#a4e6ef15df0a3abd280bf6f04d4c2b95a">head_hash</a>)) {</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;            bloop-&gt;<a class="code" href="structbucket__loop.html#a91dd157ebd0336f01305dba937d13b76">head</a> = bloop-&gt;<a class="code" href="structbucket__loop.html#a91dd157ebd0336f01305dba937d13b76">head</a>-&gt;<a class="code" href="structblist__obj.html#aa2ccd4f4869b457fcca8ada6042bdb96">next</a>;</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        }</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    }</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <span class="keywordflow">while</span> (!bloop-&gt;<a class="code" href="structbucket__loop.html#a91dd157ebd0336f01305dba937d13b76">head</a> || !bloop-&gt;<a class="code" href="structbucket__loop.html#a91dd157ebd0336f01305dba937d13b76">head</a>-&gt;<a class="code" href="structblist__obj.html#a61ae75a0a5d05916a302d365e7ca470a">prev</a>) {</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        pthread_mutex_unlock(&amp;blist-&gt;<a class="code" href="structbucket__list.html#a55970b0d3a70126a24caee83bd6889d5">locks</a>[bloop-&gt;<a class="code" href="structbucket__loop.html#a5786da1ec8486c4293e2abf4fc554b40">bucket</a>]);</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        bloop-&gt;<a class="code" href="structbucket__loop.html#a5786da1ec8486c4293e2abf4fc554b40">bucket</a>++;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        <span class="keywordflow">if</span> (bloop-&gt;<a class="code" href="structbucket__loop.html#a5786da1ec8486c4293e2abf4fc554b40">bucket</a> &lt; (1 &lt;&lt; blist-&gt;<a class="code" href="structbucket__list.html#a27d5a7bc37cf67aac5131f3ae21c1893">bucketbits</a>)) {</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;            pthread_mutex_lock(&amp;blist-&gt;<a class="code" href="structbucket__list.html#a55970b0d3a70126a24caee83bd6889d5">locks</a>[bloop-&gt;<a class="code" href="structbucket__loop.html#a5786da1ec8486c4293e2abf4fc554b40">bucket</a>]);</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;            bloop-&gt;<a class="code" href="structbucket__loop.html#a91dd157ebd0336f01305dba937d13b76">head</a> = blist-&gt;<a class="code" href="structbucket__list.html#a39f6f08d43f8c26616cac2a37ae2856c">list</a>[bloop-&gt;<a class="code" href="structbucket__loop.html#a5786da1ec8486c4293e2abf4fc554b40">bucket</a>];</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;            <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;        }</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    }</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="keywordflow">if</span> (bloop-&gt;<a class="code" href="structbucket__loop.html#a91dd157ebd0336f01305dba937d13b76">head</a>) {</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;        bloop-&gt;<a class="code" href="structbucket__loop.html#a25c4c5aefd932a39f8d444ef7cdd1fa1">cur</a> = bloop-&gt;<a class="code" href="structbucket__loop.html#a91dd157ebd0336f01305dba937d13b76">head</a>;</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;        entry = (bloop-&gt;<a class="code" href="structbucket__loop.html#a91dd157ebd0336f01305dba937d13b76">head</a>-&gt;<a class="code" href="structblist__obj.html#a6fa1ad5e6615e1e7fd15743800d9e78f">data</a>) ? bloop-&gt;<a class="code" href="structbucket__loop.html#a91dd157ebd0336f01305dba937d13b76">head</a>-&gt;<a class="code" href="structblist__obj.html#a6fa1ad5e6615e1e7fd15743800d9e78f">data</a> : NULL;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;        data = (entry) ? entry-&gt;<a class="code" href="structref__obj.html#a4725a0b14472b6571c3901ccc71bae08">data</a> : NULL;</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        <a class="code" href="group___l_i_b-_o_b_j.html#ga3a67a6d45e39f530beb6e45b6b7e7d3b">objref</a>(data);</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        bloop-&gt;<a class="code" href="structbucket__loop.html#a91dd157ebd0336f01305dba937d13b76">head</a> = bloop-&gt;<a class="code" href="structbucket__loop.html#a91dd157ebd0336f01305dba937d13b76">head</a>-&gt;<a class="code" href="structblist__obj.html#aa2ccd4f4869b457fcca8ada6042bdb96">next</a>;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        bloop-&gt;<a class="code" href="structbucket__loop.html#a4e6ef15df0a3abd280bf6f04d4c2b95a">head_hash</a> = (bloop-&gt;<a class="code" href="structbucket__loop.html#a91dd157ebd0336f01305dba937d13b76">head</a>) ? bloop-&gt;<a class="code" href="structbucket__loop.html#a91dd157ebd0336f01305dba937d13b76">head</a>-&gt;<a class="code" href="structblist__obj.html#a10e72984c2a9c6a3de07586c5d8a79c5">hash</a> : 0;</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        bloop-&gt;<a class="code" href="structbucket__loop.html#a20c18d1924487b7918f2d9cee958ebc5">cur_hash</a> = (bloop-&gt;<a class="code" href="structbucket__loop.html#a25c4c5aefd932a39f8d444ef7cdd1fa1">cur</a>) ? bloop-&gt;<a class="code" href="structbucket__loop.html#a25c4c5aefd932a39f8d444ef7cdd1fa1">cur</a>-&gt;<a class="code" href="structblist__obj.html#a10e72984c2a9c6a3de07586c5d8a79c5">hash</a> : 0;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    }</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    pthread_mutex_unlock(&amp;blist-&gt;<a class="code" href="structbucket__list.html#a55970b0d3a70126a24caee83bd6889d5">locks</a>[bloop-&gt;<a class="code" href="structbucket__loop.html#a5786da1ec8486c4293e2abf4fc554b40">bucket</a>]);</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;    <span class="keywordflow">return</span> (data);</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;}</div>
<div class="ttc" id="structbucket__list_html_a39f6f08d43f8c26616cac2a37ae2856c"><div class="ttname"><a href="structbucket__list.html#a39f6f08d43f8c26616cac2a37ae2856c">bucket_list::list</a></div><div class="ttdeci">struct blist_obj ** list</div><div class="ttdoc">Array of blist_obj one per bucket ie 2^bucketbits. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00083">refobj.c:83</a></div></div>
<div class="ttc" id="group___l_i_b-_o_b_j_html_ga3a67a6d45e39f530beb6e45b6b7e7d3b"><div class="ttname"><a href="group___l_i_b-_o_b_j.html#ga3a67a6d45e39f530beb6e45b6b7e7d3b">objref</a></div><div class="ttdeci">int objref(void *data)</div><div class="ttdoc">Reference a object. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00153">refobj.c:153</a></div></div>
<div class="ttc" id="structbucket__loop_html_a4e6ef15df0a3abd280bf6f04d4c2b95a"><div class="ttname"><a href="structbucket__loop.html#a4e6ef15df0a3abd280bf6f04d4c2b95a">bucket_loop::head_hash</a></div><div class="ttdeci">uint32_t head_hash</div><div class="ttdoc">Hash of head if we need to comeback. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00106">refobj.c:106</a></div></div>
<div class="ttc" id="structbucket__loop_html_a5786da1ec8486c4293e2abf4fc554b40"><div class="ttname"><a href="structbucket__loop.html#a5786da1ec8486c4293e2abf4fc554b40">bucket_loop::bucket</a></div><div class="ttdeci">unsigned short bucket</div><div class="ttdoc">Active bucket as determined by hash. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00101">refobj.c:101</a></div></div>
<div class="ttc" id="structblist__obj_html_a10e72984c2a9c6a3de07586c5d8a79c5"><div class="ttname"><a href="structblist__obj.html#a10e72984c2a9c6a3de07586c5d8a79c5">blist_obj::hash</a></div><div class="ttdeci">int32_t hash</div><div class="ttdoc">Hash value calculated from the data. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00064">refobj.c:64</a></div></div>
<div class="ttc" id="structbucket__loop_html_a91dd157ebd0336f01305dba937d13b76"><div class="ttname"><a href="structbucket__loop.html#a91dd157ebd0336f01305dba937d13b76">bucket_loop::head</a></div><div class="ttdeci">struct blist_obj * head</div><div class="ttdoc">Current bucket. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00110">refobj.c:110</a></div></div>
<div class="ttc" id="structbucket__loop_html_a25c4c5aefd932a39f8d444ef7cdd1fa1"><div class="ttname"><a href="structbucket__loop.html#a25c4c5aefd932a39f8d444ef7cdd1fa1">bucket_loop::cur</a></div><div class="ttdeci">struct blist_obj * cur</div><div class="ttdoc">Current item. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00112">refobj.c:112</a></div></div>
<div class="ttc" id="structbucket__list_html_a38a8dcfedb85da3556814085382f2bea"><div class="ttname"><a href="structbucket__list.html#a38a8dcfedb85da3556814085382f2bea">bucket_list::version</a></div><div class="ttdeci">size_t * version</div><div class="ttdoc">version of the bucket to detect changes during iteration (loop) </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00087">refobj.c:87</a></div></div>
<div class="ttc" id="structref__obj_html"><div class="ttname"><a href="structref__obj.html">ref_obj</a></div><div class="ttdoc">Internal structure of all referenced objects. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00038">refobj.c:38</a></div></div>
<div class="ttc" id="structblist__obj_html_a61ae75a0a5d05916a302d365e7ca470a"><div class="ttname"><a href="structblist__obj.html#a61ae75a0a5d05916a302d365e7ca470a">blist_obj::prev</a></div><div class="ttdeci">struct blist_obj * prev</div><div class="ttdoc">Previous entry in the bucket. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00068">refobj.c:68</a></div></div>
<div class="ttc" id="structref__obj_html_a4725a0b14472b6571c3901ccc71bae08"><div class="ttname"><a href="structref__obj.html#a4725a0b14472b6571c3901ccc71bae08">ref_obj::data</a></div><div class="ttdeci">void * data</div><div class="ttdoc">Pointer to the data referenced. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00054">refobj.c:54</a></div></div>
<div class="ttc" id="structbucket__loop_html_a490142bbc1e0b029834e8e2e5b548ecb"><div class="ttname"><a href="structbucket__loop.html#a490142bbc1e0b029834e8e2e5b548ecb">bucket_loop::version</a></div><div class="ttdeci">size_t version</div><div class="ttdoc">Our version check this with blist to determine if we must rewined and fast forward. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00104">refobj.c:104</a></div></div>
<div class="ttc" id="structblist__obj_html_aa2ccd4f4869b457fcca8ada6042bdb96"><div class="ttname"><a href="structblist__obj.html#aa2ccd4f4869b457fcca8ada6042bdb96">blist_obj::next</a></div><div class="ttdeci">struct blist_obj * next</div><div class="ttdoc">Next entry in the bucket. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00066">refobj.c:66</a></div></div>
<div class="ttc" id="structbucket__loop_html_aa56b1e578b1d53f1a9c3a4b9abb694e3"><div class="ttname"><a href="structbucket__loop.html#aa56b1e578b1d53f1a9c3a4b9abb694e3">bucket_loop::blist</a></div><div class="ttdeci">struct bucket_list * blist</div><div class="ttdoc">Referenece to the bucket been itereated. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00099">refobj.c:99</a></div></div>
<div class="ttc" id="structbucket__list_html_a55970b0d3a70126a24caee83bd6889d5"><div class="ttname"><a href="structbucket__list.html#a55970b0d3a70126a24caee83bd6889d5">bucket_list::locks</a></div><div class="ttdeci">pthread_mutex_t * locks</div><div class="ttdoc">Array of locks one per bucket. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00085">refobj.c:85</a></div></div>
<div class="ttc" id="structbucket__list_html_a27d5a7bc37cf67aac5131f3ae21c1893"><div class="ttname"><a href="structbucket__list.html#a27d5a7bc37cf67aac5131f3ae21c1893">bucket_list::bucketbits</a></div><div class="ttdeci">unsigned short bucketbits</div><div class="ttdoc">number of buckets 2^n </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00077">refobj.c:77</a></div></div>
<div class="ttc" id="structbucket__loop_html_a20c18d1924487b7918f2d9cee958ebc5"><div class="ttname"><a href="structbucket__loop.html#a20c18d1924487b7918f2d9cee958ebc5">bucket_loop::cur_hash</a></div><div class="ttdeci">uint32_t cur_hash</div><div class="ttdoc">Hash of cur if we need to comeback. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00108">refobj.c:108</a></div></div>
<div class="ttc" id="structblist__obj_html_a6fa1ad5e6615e1e7fd15743800d9e78f"><div class="ttname"><a href="structblist__obj.html#a6fa1ad5e6615e1e7fd15743800d9e78f">blist_obj::data</a></div><div class="ttdeci">struct ref_obj * data</div><div class="ttdoc">Reference to data held. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00070">refobj.c:70</a></div></div>
<div class="ttc" id="structbucket__list_html"><div class="ttname"><a href="structbucket__list.html">bucket_list</a></div><div class="ttdoc">Bucket list, hold hashed objects in buckets. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00075">refobj.c:75</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga610e2d3a459838f394de26e8d1320253"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void remove_bucket_item </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structbucket__list.html">bucket_list</a> *&#160;</td>
          <td class="paramname"><em>blist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove and unreference a item from the list. </p>
<dl class="section note"><dt>Note</dt><dd>Dont use this function directly during iteration as it imposes performance penalties. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">blist</td><td>Bucket list to remove item from. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See Also</dt><dd><a class="el" href="group___l_i_b-_o_b_j-_bucket.html#gaab57f98566f9886d20cfa6229bd163a0" title="Safely remove a item from a list while iterating in a loop. ">remove_bucket_loop</a> </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">data</td><td>Reference to be removed and unreferenced. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="refobj_8c_source.html#l00517">517</a> of file <a class="el" href="refobj_8c_source.html">refobj.c</a>.</p>

<p>References <a class="el" href="structbucket__list.html#a27d5a7bc37cf67aac5131f3ae21c1893">bucket_list::bucketbits</a>, <a class="el" href="structbucket__list.html#a59345370e4c9bbc627770d4b0b6aa30e">bucket_list::count</a>, <a class="el" href="structref__obj.html#a4725a0b14472b6571c3901ccc71bae08">ref_obj::data</a>, <a class="el" href="structblist__obj.html#a6fa1ad5e6615e1e7fd15743800d9e78f">blist_obj::data</a>, <a class="el" href="structblist__obj.html#a10e72984c2a9c6a3de07586c5d8a79c5">blist_obj::hash</a>, <a class="el" href="structbucket__list.html#a39f6f08d43f8c26616cac2a37ae2856c">bucket_list::list</a>, <a class="el" href="structbucket__list.html#a55970b0d3a70126a24caee83bd6889d5">bucket_list::locks</a>, <a class="el" href="structblist__obj.html#aa2ccd4f4869b457fcca8ada6042bdb96">blist_obj::next</a>, <a class="el" href="group___l_i_b-_o_b_j.html#ga4af4ae14c4a3e9f3037a09237bcfeae3">objlock()</a>, <a class="el" href="group___l_i_b-_o_b_j.html#ga8c73b68730aa4452357e84af27e00008">objunlock()</a>, <a class="el" href="group___l_i_b-_o_b_j.html#ga88a966a194cdf36fe9b5be0917ce86d9">objunref()</a>, <a class="el" href="structblist__obj.html#a61ae75a0a5d05916a302d365e7ca470a">blist_obj::prev</a>, and <a class="el" href="structbucket__list.html#a38a8dcfedb85da3556814085382f2bea">bucket_list::version</a>.</p>

<p>Referenced by <a class="el" href="group___l_i_b-_l_d_a_p.html#ga9259d04f5cd09ec2bf0f96c904976f5e">ldap_unref_attr()</a>, and <a class="el" href="group___l_i_b-_l_d_a_p.html#ga293cb196f673abba19c663a64c0943f4">ldap_unref_entry()</a>.</p>
<div class="fragment"><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                                                                      {</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;    <span class="keyword">struct </span><a class="code" href="structblist__obj.html">blist_obj</a> *entry;</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    <span class="keywordtype">int</span> <a class="code" href="structblist__obj.html#a10e72984c2a9c6a3de07586c5d8a79c5">hash</a>, bucket;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    hash = gethash(blist, <a class="code" href="structblist__obj.html#a6fa1ad5e6615e1e7fd15743800d9e78f">data</a>, 0);</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    bucket = ((hash &gt;&gt; (32 - blist-&gt;<a class="code" href="structbucket__list.html#a27d5a7bc37cf67aac5131f3ae21c1893">bucketbits</a>)) &amp; ((1 &lt;&lt; blist-&gt;<a class="code" href="structbucket__list.html#a27d5a7bc37cf67aac5131f3ae21c1893">bucketbits</a>) - 1));</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    pthread_mutex_lock(&amp;blist-&gt;<a class="code" href="structbucket__list.html#a55970b0d3a70126a24caee83bd6889d5">locks</a>[bucket]);</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    entry = blist_gotohash(blist-&gt;<a class="code" href="structbucket__list.html#a39f6f08d43f8c26616cac2a37ae2856c">list</a>[bucket], hash + 1, blist-&gt;<a class="code" href="structbucket__list.html#a27d5a7bc37cf67aac5131f3ae21c1893">bucketbits</a>);</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="keywordflow">if</span> (entry &amp;&amp; entry-&gt;<a class="code" href="structblist__obj.html#a10e72984c2a9c6a3de07586c5d8a79c5">hash</a> == hash) {</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        <span class="keywordflow">if</span> (entry-&gt;<a class="code" href="structblist__obj.html#aa2ccd4f4869b457fcca8ada6042bdb96">next</a> &amp;&amp; (entry == blist-&gt;<a class="code" href="structbucket__list.html#a39f6f08d43f8c26616cac2a37ae2856c">list</a>[bucket])) {</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;            entry-&gt;<a class="code" href="structblist__obj.html#aa2ccd4f4869b457fcca8ada6042bdb96">next</a>-&gt;<a class="code" href="structblist__obj.html#a61ae75a0a5d05916a302d365e7ca470a">prev</a> = entry-&gt;<a class="code" href="structblist__obj.html#a61ae75a0a5d05916a302d365e7ca470a">prev</a>;</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;            blist-&gt;<a class="code" href="structbucket__list.html#a39f6f08d43f8c26616cac2a37ae2856c">list</a>[bucket] = entry-&gt;<a class="code" href="structblist__obj.html#aa2ccd4f4869b457fcca8ada6042bdb96">next</a>;</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (entry-&gt;<a class="code" href="structblist__obj.html#aa2ccd4f4869b457fcca8ada6042bdb96">next</a>) {</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;            entry-&gt;<a class="code" href="structblist__obj.html#aa2ccd4f4869b457fcca8ada6042bdb96">next</a>-&gt;<a class="code" href="structblist__obj.html#a61ae75a0a5d05916a302d365e7ca470a">prev</a> = entry-&gt;<a class="code" href="structblist__obj.html#a61ae75a0a5d05916a302d365e7ca470a">prev</a>;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;            entry-&gt;<a class="code" href="structblist__obj.html#a61ae75a0a5d05916a302d365e7ca470a">prev</a>-&gt;<a class="code" href="structblist__obj.html#aa2ccd4f4869b457fcca8ada6042bdb96">next</a> = entry-&gt;<a class="code" href="structblist__obj.html#aa2ccd4f4869b457fcca8ada6042bdb96">next</a>;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (entry == blist-&gt;<a class="code" href="structbucket__list.html#a39f6f08d43f8c26616cac2a37ae2856c">list</a>[bucket]) {</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;            blist-&gt;<a class="code" href="structbucket__list.html#a39f6f08d43f8c26616cac2a37ae2856c">list</a>[bucket] = NULL;</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;            entry-&gt;<a class="code" href="structblist__obj.html#a61ae75a0a5d05916a302d365e7ca470a">prev</a>-&gt;<a class="code" href="structblist__obj.html#aa2ccd4f4869b457fcca8ada6042bdb96">next</a> = NULL;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;            blist-&gt;<a class="code" href="structbucket__list.html#a39f6f08d43f8c26616cac2a37ae2856c">list</a>[bucket]-&gt;<a class="code" href="structblist__obj.html#a61ae75a0a5d05916a302d365e7ca470a">prev</a> = entry-&gt;<a class="code" href="structblist__obj.html#a61ae75a0a5d05916a302d365e7ca470a">prev</a>;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        }</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        <a class="code" href="group___l_i_b-_o_b_j.html#ga88a966a194cdf36fe9b5be0917ce86d9">objunref</a>(entry-&gt;<a class="code" href="structblist__obj.html#a6fa1ad5e6615e1e7fd15743800d9e78f">data</a>-&gt;<a class="code" href="structref__obj.html#a4725a0b14472b6571c3901ccc71bae08">data</a>);</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        free(entry);</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        <a class="code" href="group___l_i_b-_o_b_j.html#ga4af4ae14c4a3e9f3037a09237bcfeae3">objlock</a>(blist);</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        blist-&gt;<a class="code" href="structbucket__list.html#a59345370e4c9bbc627770d4b0b6aa30e">count</a>--;</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        blist-&gt;<a class="code" href="structbucket__list.html#a38a8dcfedb85da3556814085382f2bea">version</a>[bucket]++;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        <a class="code" href="group___l_i_b-_o_b_j.html#ga8c73b68730aa4452357e84af27e00008">objunlock</a>(blist);</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    }</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    pthread_mutex_unlock(&amp;blist-&gt;<a class="code" href="structbucket__list.html#a55970b0d3a70126a24caee83bd6889d5">locks</a>[bucket]);</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;}</div>
<div class="ttc" id="structbucket__list_html_a39f6f08d43f8c26616cac2a37ae2856c"><div class="ttname"><a href="structbucket__list.html#a39f6f08d43f8c26616cac2a37ae2856c">bucket_list::list</a></div><div class="ttdeci">struct blist_obj ** list</div><div class="ttdoc">Array of blist_obj one per bucket ie 2^bucketbits. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00083">refobj.c:83</a></div></div>
<div class="ttc" id="group___l_i_b-_o_b_j_html_ga4af4ae14c4a3e9f3037a09237bcfeae3"><div class="ttname"><a href="group___l_i_b-_o_b_j.html#ga4af4ae14c4a3e9f3037a09237bcfeae3">objlock</a></div><div class="ttdeci">int objlock(void *data)</div><div class="ttdoc">Lock the reference. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00269">refobj.c:269</a></div></div>
<div class="ttc" id="structblist__obj_html_a10e72984c2a9c6a3de07586c5d8a79c5"><div class="ttname"><a href="structblist__obj.html#a10e72984c2a9c6a3de07586c5d8a79c5">blist_obj::hash</a></div><div class="ttdeci">int32_t hash</div><div class="ttdoc">Hash value calculated from the data. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00064">refobj.c:64</a></div></div>
<div class="ttc" id="structblist__obj_html"><div class="ttname"><a href="structblist__obj.html">blist_obj</a></div><div class="ttdoc">Entry in a bucket list. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00061">refobj.c:61</a></div></div>
<div class="ttc" id="structbucket__list_html_a59345370e4c9bbc627770d4b0b6aa30e"><div class="ttname"><a href="structbucket__list.html#a59345370e4c9bbc627770d4b0b6aa30e">bucket_list::count</a></div><div class="ttdeci">size_t count</div><div class="ttdoc">Number of items held. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00079">refobj.c:79</a></div></div>
<div class="ttc" id="structbucket__list_html_a38a8dcfedb85da3556814085382f2bea"><div class="ttname"><a href="structbucket__list.html#a38a8dcfedb85da3556814085382f2bea">bucket_list::version</a></div><div class="ttdeci">size_t * version</div><div class="ttdoc">version of the bucket to detect changes during iteration (loop) </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00087">refobj.c:87</a></div></div>
<div class="ttc" id="structblist__obj_html_a61ae75a0a5d05916a302d365e7ca470a"><div class="ttname"><a href="structblist__obj.html#a61ae75a0a5d05916a302d365e7ca470a">blist_obj::prev</a></div><div class="ttdeci">struct blist_obj * prev</div><div class="ttdoc">Previous entry in the bucket. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00068">refobj.c:68</a></div></div>
<div class="ttc" id="structref__obj_html_a4725a0b14472b6571c3901ccc71bae08"><div class="ttname"><a href="structref__obj.html#a4725a0b14472b6571c3901ccc71bae08">ref_obj::data</a></div><div class="ttdeci">void * data</div><div class="ttdoc">Pointer to the data referenced. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00054">refobj.c:54</a></div></div>
<div class="ttc" id="group___l_i_b-_o_b_j_html_ga8c73b68730aa4452357e84af27e00008"><div class="ttname"><a href="group___l_i_b-_o_b_j.html#ga8c73b68730aa4452357e84af27e00008">objunlock</a></div><div class="ttdeci">int objunlock(void *data)</div><div class="ttdoc">Unlock a reference. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00301">refobj.c:301</a></div></div>
<div class="ttc" id="structblist__obj_html_aa2ccd4f4869b457fcca8ada6042bdb96"><div class="ttname"><a href="structblist__obj.html#aa2ccd4f4869b457fcca8ada6042bdb96">blist_obj::next</a></div><div class="ttdeci">struct blist_obj * next</div><div class="ttdoc">Next entry in the bucket. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00066">refobj.c:66</a></div></div>
<div class="ttc" id="structbucket__list_html_a55970b0d3a70126a24caee83bd6889d5"><div class="ttname"><a href="structbucket__list.html#a55970b0d3a70126a24caee83bd6889d5">bucket_list::locks</a></div><div class="ttdeci">pthread_mutex_t * locks</div><div class="ttdoc">Array of locks one per bucket. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00085">refobj.c:85</a></div></div>
<div class="ttc" id="structbucket__list_html_a27d5a7bc37cf67aac5131f3ae21c1893"><div class="ttname"><a href="structbucket__list.html#a27d5a7bc37cf67aac5131f3ae21c1893">bucket_list::bucketbits</a></div><div class="ttdeci">unsigned short bucketbits</div><div class="ttdoc">number of buckets 2^n </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00077">refobj.c:77</a></div></div>
<div class="ttc" id="group___l_i_b-_o_b_j_html_ga88a966a194cdf36fe9b5be0917ce86d9"><div class="ttname"><a href="group___l_i_b-_o_b_j.html#ga88a966a194cdf36fe9b5be0917ce86d9">objunref</a></div><div class="ttdeci">int objunref(void *data)</div><div class="ttdoc">Drop reference held. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00184">refobj.c:184</a></div></div>
<div class="ttc" id="structblist__obj_html_a6fa1ad5e6615e1e7fd15743800d9e78f"><div class="ttname"><a href="structblist__obj.html#a6fa1ad5e6615e1e7fd15743800d9e78f">blist_obj::data</a></div><div class="ttdeci">struct ref_obj * data</div><div class="ttdoc">Reference to data held. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00070">refobj.c:70</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gaab57f98566f9886d20cfa6229bd163a0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void remove_bucket_loop </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structbucket__loop.html">bucket_loop</a> *&#160;</td>
          <td class="paramname"><em>bloop</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Safely remove a item from a list while iterating in a loop. </p>
<p>While traversing the bucket list its best to use this function to remove a reference and delete it from the list. </p>
<dl class="section note"><dt>Note</dt><dd>Removeing a item from the list without using this function will cause the the version to change and the iterator to rewind and fast forward. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">bloop</td><td>Bucket iterator. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="refobj_8c_source.html#l00710">710</a> of file <a class="el" href="refobj_8c_source.html">refobj.c</a>.</p>

<p>References <a class="el" href="structbucket__loop.html#aa56b1e578b1d53f1a9c3a4b9abb694e3">bucket_loop::blist</a>, <a class="el" href="structbucket__loop.html#a5786da1ec8486c4293e2abf4fc554b40">bucket_loop::bucket</a>, <a class="el" href="structbucket__list.html#a27d5a7bc37cf67aac5131f3ae21c1893">bucket_list::bucketbits</a>, <a class="el" href="structbucket__list.html#a59345370e4c9bbc627770d4b0b6aa30e">bucket_list::count</a>, <a class="el" href="structbucket__loop.html#a25c4c5aefd932a39f8d444ef7cdd1fa1">bucket_loop::cur</a>, <a class="el" href="structbucket__loop.html#a20c18d1924487b7918f2d9cee958ebc5">bucket_loop::cur_hash</a>, <a class="el" href="structref__obj.html#a4725a0b14472b6571c3901ccc71bae08">ref_obj::data</a>, <a class="el" href="structblist__obj.html#a6fa1ad5e6615e1e7fd15743800d9e78f">blist_obj::data</a>, <a class="el" href="structblist__obj.html#a10e72984c2a9c6a3de07586c5d8a79c5">blist_obj::hash</a>, <a class="el" href="structbucket__list.html#a39f6f08d43f8c26616cac2a37ae2856c">bucket_list::list</a>, <a class="el" href="structbucket__list.html#a55970b0d3a70126a24caee83bd6889d5">bucket_list::locks</a>, <a class="el" href="structblist__obj.html#aa2ccd4f4869b457fcca8ada6042bdb96">blist_obj::next</a>, <a class="el" href="group___l_i_b-_o_b_j.html#ga4af4ae14c4a3e9f3037a09237bcfeae3">objlock()</a>, <a class="el" href="group___l_i_b-_o_b_j.html#ga8c73b68730aa4452357e84af27e00008">objunlock()</a>, <a class="el" href="group___l_i_b-_o_b_j.html#ga88a966a194cdf36fe9b5be0917ce86d9">objunref()</a>, <a class="el" href="structblist__obj.html#a61ae75a0a5d05916a302d365e7ca470a">blist_obj::prev</a>, <a class="el" href="structbucket__list.html#a38a8dcfedb85da3556814085382f2bea">bucket_list::version</a>, and <a class="el" href="structbucket__loop.html#a490142bbc1e0b029834e8e2e5b548ecb">bucket_loop::version</a>.</p>
<div class="fragment"><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                                                          {</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    <span class="keyword">struct </span><a class="code" href="structbucket__list.html">bucket_list</a> *blist = bloop-&gt;<a class="code" href="structbucket__loop.html#aa56b1e578b1d53f1a9c3a4b9abb694e3">blist</a>;</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    <span class="keywordtype">int</span> bucket = bloop-&gt;<a class="code" href="structbucket__loop.html#a5786da1ec8486c4293e2abf4fc554b40">bucket</a>;</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    pthread_mutex_lock(&amp;blist-&gt;<a class="code" href="structbucket__list.html#a55970b0d3a70126a24caee83bd6889d5">locks</a>[bloop-&gt;<a class="code" href="structbucket__loop.html#a5786da1ec8486c4293e2abf4fc554b40">bucket</a>]);</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <span class="comment">/*if the bucket has altered need to verify i can remove*/</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <span class="keywordflow">if</span> (bloop-&gt;<a class="code" href="structbucket__loop.html#a20c18d1924487b7918f2d9cee958ebc5">cur_hash</a> &amp;&amp; (!bloop-&gt;<a class="code" href="structbucket__loop.html#a25c4c5aefd932a39f8d444ef7cdd1fa1">cur</a> || (blist-&gt;<a class="code" href="structbucket__list.html#a38a8dcfedb85da3556814085382f2bea">version</a>[bloop-&gt;<a class="code" href="structbucket__loop.html#a5786da1ec8486c4293e2abf4fc554b40">bucket</a>] != bloop-&gt;<a class="code" href="structbucket__loop.html#a490142bbc1e0b029834e8e2e5b548ecb">version</a>))) {</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;        bloop-&gt;<a class="code" href="structbucket__loop.html#a25c4c5aefd932a39f8d444ef7cdd1fa1">cur</a> = blist_gotohash(blist-&gt;<a class="code" href="structbucket__list.html#a39f6f08d43f8c26616cac2a37ae2856c">list</a>[bloop-&gt;<a class="code" href="structbucket__loop.html#a5786da1ec8486c4293e2abf4fc554b40">bucket</a>], bloop-&gt;<a class="code" href="structbucket__loop.html#a20c18d1924487b7918f2d9cee958ebc5">cur_hash</a> + 1, blist-&gt;<a class="code" href="structbucket__list.html#a27d5a7bc37cf67aac5131f3ae21c1893">bucketbits</a>);</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;        <span class="keywordflow">if</span> (!bloop-&gt;<a class="code" href="structbucket__loop.html#a25c4c5aefd932a39f8d444ef7cdd1fa1">cur</a> || (bloop-&gt;<a class="code" href="structbucket__loop.html#a25c4c5aefd932a39f8d444ef7cdd1fa1">cur</a>-&gt;<a class="code" href="structblist__obj.html#a10e72984c2a9c6a3de07586c5d8a79c5">hash</a> != bloop-&gt;<a class="code" href="structbucket__loop.html#a20c18d1924487b7918f2d9cee958ebc5">cur_hash</a>)) {</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;            pthread_mutex_unlock(&amp;blist-&gt;<a class="code" href="structbucket__list.html#a55970b0d3a70126a24caee83bd6889d5">locks</a>[bucket]);</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        }</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    }</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;    <span class="keywordflow">if</span> (!bloop-&gt;<a class="code" href="structbucket__loop.html#a25c4c5aefd932a39f8d444ef7cdd1fa1">cur</a>) {</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        pthread_mutex_unlock(&amp;blist-&gt;<a class="code" href="structbucket__list.html#a55970b0d3a70126a24caee83bd6889d5">locks</a>[bucket]);</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    }</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <span class="keywordflow">if</span> (bloop-&gt;<a class="code" href="structbucket__loop.html#a25c4c5aefd932a39f8d444ef7cdd1fa1">cur</a>-&gt;<a class="code" href="structblist__obj.html#aa2ccd4f4869b457fcca8ada6042bdb96">next</a> &amp;&amp; (bloop-&gt;<a class="code" href="structbucket__loop.html#a25c4c5aefd932a39f8d444ef7cdd1fa1">cur</a> == blist-&gt;<a class="code" href="structbucket__list.html#a39f6f08d43f8c26616cac2a37ae2856c">list</a>[bucket])) {</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;        bloop-&gt;<a class="code" href="structbucket__loop.html#a25c4c5aefd932a39f8d444ef7cdd1fa1">cur</a>-&gt;<a class="code" href="structblist__obj.html#aa2ccd4f4869b457fcca8ada6042bdb96">next</a>-&gt;<a class="code" href="structblist__obj.html#a61ae75a0a5d05916a302d365e7ca470a">prev</a> = bloop-&gt;<a class="code" href="structbucket__loop.html#a25c4c5aefd932a39f8d444ef7cdd1fa1">cur</a>-&gt;<a class="code" href="structblist__obj.html#a61ae75a0a5d05916a302d365e7ca470a">prev</a>;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;        blist-&gt;<a class="code" href="structbucket__list.html#a39f6f08d43f8c26616cac2a37ae2856c">list</a>[bucket] = bloop-&gt;<a class="code" href="structbucket__loop.html#a25c4c5aefd932a39f8d444ef7cdd1fa1">cur</a>-&gt;<a class="code" href="structblist__obj.html#aa2ccd4f4869b457fcca8ada6042bdb96">next</a>;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bloop-&gt;<a class="code" href="structbucket__loop.html#a25c4c5aefd932a39f8d444ef7cdd1fa1">cur</a>-&gt;<a class="code" href="structblist__obj.html#aa2ccd4f4869b457fcca8ada6042bdb96">next</a>) {</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;        bloop-&gt;<a class="code" href="structbucket__loop.html#a25c4c5aefd932a39f8d444ef7cdd1fa1">cur</a>-&gt;<a class="code" href="structblist__obj.html#aa2ccd4f4869b457fcca8ada6042bdb96">next</a>-&gt;<a class="code" href="structblist__obj.html#a61ae75a0a5d05916a302d365e7ca470a">prev</a> = bloop-&gt;<a class="code" href="structbucket__loop.html#a25c4c5aefd932a39f8d444ef7cdd1fa1">cur</a>-&gt;<a class="code" href="structblist__obj.html#a61ae75a0a5d05916a302d365e7ca470a">prev</a>;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;        bloop-&gt;<a class="code" href="structbucket__loop.html#a25c4c5aefd932a39f8d444ef7cdd1fa1">cur</a>-&gt;<a class="code" href="structblist__obj.html#a61ae75a0a5d05916a302d365e7ca470a">prev</a>-&gt;<a class="code" href="structblist__obj.html#aa2ccd4f4869b457fcca8ada6042bdb96">next</a> = bloop-&gt;<a class="code" href="structbucket__loop.html#a25c4c5aefd932a39f8d444ef7cdd1fa1">cur</a>-&gt;<a class="code" href="structblist__obj.html#aa2ccd4f4869b457fcca8ada6042bdb96">next</a>;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bloop-&gt;<a class="code" href="structbucket__loop.html#a25c4c5aefd932a39f8d444ef7cdd1fa1">cur</a> == blist-&gt;<a class="code" href="structbucket__list.html#a39f6f08d43f8c26616cac2a37ae2856c">list</a>[bucket]) {</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;        blist-&gt;<a class="code" href="structbucket__list.html#a39f6f08d43f8c26616cac2a37ae2856c">list</a>[bucket] = NULL;</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;        bloop-&gt;<a class="code" href="structbucket__loop.html#a25c4c5aefd932a39f8d444ef7cdd1fa1">cur</a>-&gt;<a class="code" href="structblist__obj.html#a61ae75a0a5d05916a302d365e7ca470a">prev</a>-&gt;<a class="code" href="structblist__obj.html#aa2ccd4f4869b457fcca8ada6042bdb96">next</a> = NULL;</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;        blist-&gt;<a class="code" href="structbucket__list.html#a39f6f08d43f8c26616cac2a37ae2856c">list</a>[bucket]-&gt;<a class="code" href="structblist__obj.html#a61ae75a0a5d05916a302d365e7ca470a">prev</a> = bloop-&gt;<a class="code" href="structbucket__loop.html#a25c4c5aefd932a39f8d444ef7cdd1fa1">cur</a>-&gt;<a class="code" href="structblist__obj.html#a61ae75a0a5d05916a302d365e7ca470a">prev</a>;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    }</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;    <a class="code" href="group___l_i_b-_o_b_j.html#ga88a966a194cdf36fe9b5be0917ce86d9">objunref</a>(bloop-&gt;<a class="code" href="structbucket__loop.html#a25c4c5aefd932a39f8d444ef7cdd1fa1">cur</a>-&gt;<a class="code" href="structblist__obj.html#a6fa1ad5e6615e1e7fd15743800d9e78f">data</a>-&gt;<a class="code" href="structref__obj.html#a4725a0b14472b6571c3901ccc71bae08">data</a>);</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    free(bloop-&gt;<a class="code" href="structbucket__loop.html#a25c4c5aefd932a39f8d444ef7cdd1fa1">cur</a>);</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    bloop-&gt;<a class="code" href="structbucket__loop.html#a20c18d1924487b7918f2d9cee958ebc5">cur_hash</a> = 0;</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    bloop-&gt;<a class="code" href="structbucket__loop.html#a25c4c5aefd932a39f8d444ef7cdd1fa1">cur</a> = NULL;</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    blist-&gt;<a class="code" href="structbucket__list.html#a38a8dcfedb85da3556814085382f2bea">version</a>[bucket]++;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    bloop-&gt;<a class="code" href="structbucket__loop.html#a490142bbc1e0b029834e8e2e5b548ecb">version</a>++;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    pthread_mutex_unlock(&amp;blist-&gt;<a class="code" href="structbucket__list.html#a55970b0d3a70126a24caee83bd6889d5">locks</a>[bucket]);</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    <a class="code" href="group___l_i_b-_o_b_j.html#ga4af4ae14c4a3e9f3037a09237bcfeae3">objlock</a>(blist);</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    blist-&gt;<a class="code" href="structbucket__list.html#a59345370e4c9bbc627770d4b0b6aa30e">count</a>--;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    <a class="code" href="group___l_i_b-_o_b_j.html#ga8c73b68730aa4452357e84af27e00008">objunlock</a>(blist);</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;}</div>
<div class="ttc" id="structbucket__list_html_a39f6f08d43f8c26616cac2a37ae2856c"><div class="ttname"><a href="structbucket__list.html#a39f6f08d43f8c26616cac2a37ae2856c">bucket_list::list</a></div><div class="ttdeci">struct blist_obj ** list</div><div class="ttdoc">Array of blist_obj one per bucket ie 2^bucketbits. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00083">refobj.c:83</a></div></div>
<div class="ttc" id="structbucket__loop_html_a5786da1ec8486c4293e2abf4fc554b40"><div class="ttname"><a href="structbucket__loop.html#a5786da1ec8486c4293e2abf4fc554b40">bucket_loop::bucket</a></div><div class="ttdeci">unsigned short bucket</div><div class="ttdoc">Active bucket as determined by hash. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00101">refobj.c:101</a></div></div>
<div class="ttc" id="group___l_i_b-_o_b_j_html_ga4af4ae14c4a3e9f3037a09237bcfeae3"><div class="ttname"><a href="group___l_i_b-_o_b_j.html#ga4af4ae14c4a3e9f3037a09237bcfeae3">objlock</a></div><div class="ttdeci">int objlock(void *data)</div><div class="ttdoc">Lock the reference. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00269">refobj.c:269</a></div></div>
<div class="ttc" id="structblist__obj_html_a10e72984c2a9c6a3de07586c5d8a79c5"><div class="ttname"><a href="structblist__obj.html#a10e72984c2a9c6a3de07586c5d8a79c5">blist_obj::hash</a></div><div class="ttdeci">int32_t hash</div><div class="ttdoc">Hash value calculated from the data. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00064">refobj.c:64</a></div></div>
<div class="ttc" id="structbucket__list_html_a59345370e4c9bbc627770d4b0b6aa30e"><div class="ttname"><a href="structbucket__list.html#a59345370e4c9bbc627770d4b0b6aa30e">bucket_list::count</a></div><div class="ttdeci">size_t count</div><div class="ttdoc">Number of items held. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00079">refobj.c:79</a></div></div>
<div class="ttc" id="structbucket__loop_html_a25c4c5aefd932a39f8d444ef7cdd1fa1"><div class="ttname"><a href="structbucket__loop.html#a25c4c5aefd932a39f8d444ef7cdd1fa1">bucket_loop::cur</a></div><div class="ttdeci">struct blist_obj * cur</div><div class="ttdoc">Current item. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00112">refobj.c:112</a></div></div>
<div class="ttc" id="structbucket__list_html_a38a8dcfedb85da3556814085382f2bea"><div class="ttname"><a href="structbucket__list.html#a38a8dcfedb85da3556814085382f2bea">bucket_list::version</a></div><div class="ttdeci">size_t * version</div><div class="ttdoc">version of the bucket to detect changes during iteration (loop) </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00087">refobj.c:87</a></div></div>
<div class="ttc" id="structblist__obj_html_a61ae75a0a5d05916a302d365e7ca470a"><div class="ttname"><a href="structblist__obj.html#a61ae75a0a5d05916a302d365e7ca470a">blist_obj::prev</a></div><div class="ttdeci">struct blist_obj * prev</div><div class="ttdoc">Previous entry in the bucket. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00068">refobj.c:68</a></div></div>
<div class="ttc" id="structref__obj_html_a4725a0b14472b6571c3901ccc71bae08"><div class="ttname"><a href="structref__obj.html#a4725a0b14472b6571c3901ccc71bae08">ref_obj::data</a></div><div class="ttdeci">void * data</div><div class="ttdoc">Pointer to the data referenced. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00054">refobj.c:54</a></div></div>
<div class="ttc" id="structbucket__loop_html_a490142bbc1e0b029834e8e2e5b548ecb"><div class="ttname"><a href="structbucket__loop.html#a490142bbc1e0b029834e8e2e5b548ecb">bucket_loop::version</a></div><div class="ttdeci">size_t version</div><div class="ttdoc">Our version check this with blist to determine if we must rewined and fast forward. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00104">refobj.c:104</a></div></div>
<div class="ttc" id="group___l_i_b-_o_b_j_html_ga8c73b68730aa4452357e84af27e00008"><div class="ttname"><a href="group___l_i_b-_o_b_j.html#ga8c73b68730aa4452357e84af27e00008">objunlock</a></div><div class="ttdeci">int objunlock(void *data)</div><div class="ttdoc">Unlock a reference. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00301">refobj.c:301</a></div></div>
<div class="ttc" id="structblist__obj_html_aa2ccd4f4869b457fcca8ada6042bdb96"><div class="ttname"><a href="structblist__obj.html#aa2ccd4f4869b457fcca8ada6042bdb96">blist_obj::next</a></div><div class="ttdeci">struct blist_obj * next</div><div class="ttdoc">Next entry in the bucket. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00066">refobj.c:66</a></div></div>
<div class="ttc" id="structbucket__loop_html_aa56b1e578b1d53f1a9c3a4b9abb694e3"><div class="ttname"><a href="structbucket__loop.html#aa56b1e578b1d53f1a9c3a4b9abb694e3">bucket_loop::blist</a></div><div class="ttdeci">struct bucket_list * blist</div><div class="ttdoc">Referenece to the bucket been itereated. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00099">refobj.c:99</a></div></div>
<div class="ttc" id="structbucket__list_html_a55970b0d3a70126a24caee83bd6889d5"><div class="ttname"><a href="structbucket__list.html#a55970b0d3a70126a24caee83bd6889d5">bucket_list::locks</a></div><div class="ttdeci">pthread_mutex_t * locks</div><div class="ttdoc">Array of locks one per bucket. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00085">refobj.c:85</a></div></div>
<div class="ttc" id="structbucket__list_html_a27d5a7bc37cf67aac5131f3ae21c1893"><div class="ttname"><a href="structbucket__list.html#a27d5a7bc37cf67aac5131f3ae21c1893">bucket_list::bucketbits</a></div><div class="ttdeci">unsigned short bucketbits</div><div class="ttdoc">number of buckets 2^n </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00077">refobj.c:77</a></div></div>
<div class="ttc" id="structbucket__loop_html_a20c18d1924487b7918f2d9cee958ebc5"><div class="ttname"><a href="structbucket__loop.html#a20c18d1924487b7918f2d9cee958ebc5">bucket_loop::cur_hash</a></div><div class="ttdeci">uint32_t cur_hash</div><div class="ttdoc">Hash of cur if we need to comeback. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00108">refobj.c:108</a></div></div>
<div class="ttc" id="group___l_i_b-_o_b_j_html_ga88a966a194cdf36fe9b5be0917ce86d9"><div class="ttname"><a href="group___l_i_b-_o_b_j.html#ga88a966a194cdf36fe9b5be0917ce86d9">objunref</a></div><div class="ttdeci">int objunref(void *data)</div><div class="ttdoc">Drop reference held. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00184">refobj.c:184</a></div></div>
<div class="ttc" id="structblist__obj_html_a6fa1ad5e6615e1e7fd15743800d9e78f"><div class="ttname"><a href="structblist__obj.html#a6fa1ad5e6615e1e7fd15743800d9e78f">blist_obj::data</a></div><div class="ttdeci">struct ref_obj * data</div><div class="ttdoc">Reference to data held. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00070">refobj.c:70</a></div></div>
<div class="ttc" id="structbucket__list_html"><div class="ttname"><a href="structbucket__list.html">bucket_list</a></div><div class="ttdoc">Bucket list, hold hashed objects in buckets. </div><div class="ttdef"><b>Definition:</b> <a href="refobj_8c_source.html#l00075">refobj.c:75</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Wed Oct 23 2013 10:44:29 for DTS Application Library by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
